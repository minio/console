{"version":3,"file":"static/js/7515.3c5e861f.chunk.js","mappings":"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","sources":["screens/Console/Buckets/BucketDetails/SetRetentionConfig.tsx","screens/Console/Common/ModalWrapper/ModalWrapper.tsx"],"sourcesContent":["// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React, { useEffect, useState, Fragment } from \"react\";\nimport {\n  Button,\n  Loader,\n  Grid,\n  FormLayout,\n  RadioGroup,\n  InputBox,\n  ProgressBar,\n} from \"mds\";\nimport { api } from \"api\";\nimport { ObjectRetentionMode, ObjectRetentionUnit } from \"api/consoleApi\";\nimport { errorToHandler } from \"api/errors\";\n\nimport { modalStyleUtils } from \"../../Common/FormComponents/common/styleLibrary\";\nimport { setModalErrorSnackMessage } from \"../../../../systemSlice\";\nimport { useAppDispatch } from \"../../../../store\";\nimport ModalWrapper from \"../../Common/ModalWrapper/ModalWrapper\";\n\ninterface ISetRetentionConfigProps {\n  open: boolean;\n  bucketName: string;\n  closeModalAndRefresh: () => void;\n}\n\nconst SetRetentionConfig = ({\n  open,\n  bucketName,\n  closeModalAndRefresh,\n}: ISetRetentionConfigProps) => {\n  const dispatch = useAppDispatch();\n  const [addLoading, setAddLoading] = useState<boolean>(false);\n  const [loadingForm, setLoadingForm] = useState<boolean>(true);\n  const [retentionMode, setRetentionMode] = useState<\n    ObjectRetentionMode | undefined\n  >(ObjectRetentionMode.Compliance);\n  const [retentionUnit, setRetentionUnit] = useState<\n    ObjectRetentionUnit | undefined\n  >(ObjectRetentionUnit.Days);\n  const [retentionValidity, setRetentionValidity] = useState<\n    number | undefined\n  >(1);\n  const [valid, setValid] = useState<boolean>(false);\n\n  const setRetention = (event: React.FormEvent) => {\n    event.preventDefault();\n    if (addLoading) {\n      return;\n    }\n    setAddLoading(true);\n    api.buckets\n      .setBucketRetentionConfig(bucketName, {\n        mode: retentionMode || ObjectRetentionMode.Compliance,\n        unit: retentionUnit || ObjectRetentionUnit.Days,\n        validity: retentionValidity || 1,\n      })\n      .then(() => {\n        setAddLoading(false);\n        closeModalAndRefresh();\n      })\n      .catch((err) => {\n        setAddLoading(false);\n        dispatch(setModalErrorSnackMessage(errorToHandler(err.error)));\n      });\n  };\n\n  useEffect(() => {\n    if (Number.isNaN(retentionValidity) || (retentionValidity || 1) < 1) {\n      setValid(false);\n      return;\n    }\n    setValid(true);\n  }, [retentionValidity]);\n\n  useEffect(() => {\n    if (loadingForm) {\n      api.buckets\n        .getBucketRetentionConfig(bucketName)\n        .then((res) => {\n          setLoadingForm(false);\n\n          // We set default values\n          setRetentionMode(res.data.mode);\n          setRetentionValidity(res.data.validity);\n          setRetentionUnit(res.data.unit);\n        })\n        .catch(() => {\n          setLoadingForm(false);\n        });\n    }\n  }, [loadingForm, bucketName]);\n\n  return (\n    <ModalWrapper\n      title=\"Set Retention Configuration\"\n      modalOpen={open}\n      onClose={() => {\n        closeModalAndRefresh();\n      }}\n    >\n      {loadingForm ? (\n        <Loader style={{ width: 16, height: 16 }} />\n      ) : (\n        <form\n          noValidate\n          autoComplete=\"off\"\n          onSubmit={(e: React.FormEvent<HTMLFormElement>) => {\n            setRetention(e);\n          }}\n        >\n          <FormLayout containerPadding={false} withBorders={false}>\n            <RadioGroup\n              currentValue={retentionMode as string}\n              id=\"retention_mode\"\n              name=\"retention_mode\"\n              label=\"Retention Mode\"\n              onChange={(e: React.ChangeEvent<{ value: unknown }>) => {\n                setRetentionMode(e.target.value as ObjectRetentionMode);\n              }}\n              selectorOptions={[\n                { value: \"compliance\", label: \"Compliance\" },\n                { value: \"governance\", label: \"Governance\" },\n              ]}\n              helpTip={\n                <Fragment>\n                  {\" \"}\n                  <a\n                    href=\"https://min.io/docs/minio/macos/administration/object-management/object-retention.html#minio-object-locking-compliance\"\n                    target=\"blank\"\n                  >\n                    Compliance\n                  </a>{\" \"}\n                  lock protects Objects from write operations by all users,\n                  including the MinIO root user.\n                  <br />\n                  <br />\n                  <a\n                    href=\"https://min.io/docs/minio/macos/administration/object-management/object-retention.html#minio-object-locking-governance\"\n                    target=\"blank\"\n                  >\n                    Governance\n                  </a>{\" \"}\n                  lock protects Objects from write operations by non-privileged\n                  users.\n                </Fragment>\n              }\n              helpTipPlacement=\"right\"\n            />\n            <RadioGroup\n              currentValue={retentionUnit as string}\n              id=\"retention_unit\"\n              name=\"retention_unit\"\n              label=\"Retention Unit\"\n              onChange={(e: React.ChangeEvent<{ value: unknown }>) => {\n                setRetentionUnit(e.target.value as ObjectRetentionUnit);\n              }}\n              selectorOptions={[\n                { value: \"days\", label: \"Days\" },\n                { value: \"years\", label: \"Years\" },\n              ]}\n            />\n            <InputBox\n              type=\"number\"\n              id=\"retention_validity\"\n              name=\"retention_validity\"\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setRetentionValidity(e.target.valueAsNumber);\n              }}\n              label=\"Retention Validity\"\n              value={String(retentionValidity)}\n              required\n              min=\"1\"\n            />\n            <Grid item xs={12} sx={modalStyleUtils.modalButtonBar}>\n              <Button\n                id={\"cancel\"}\n                type=\"button\"\n                variant=\"regular\"\n                disabled={addLoading}\n                onClick={() => {\n                  closeModalAndRefresh();\n                }}\n                label={\"Cancel\"}\n              />\n              <Button\n                id={\"set\"}\n                type=\"submit\"\n                variant=\"callAction\"\n                color=\"primary\"\n                disabled={addLoading || !valid}\n                label={\"Set\"}\n              />\n            </Grid>\n            {addLoading && (\n              <Grid item xs={12}>\n                <ProgressBar />\n              </Grid>\n            )}\n          </FormLayout>\n        </form>\n      )}\n    </ModalWrapper>\n  );\n};\n\nexport default SetRetentionConfig;\n","// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\nimport React, { useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { ModalBox, Snackbar } from \"mds\";\nimport { CSSObject } from \"styled-components\";\nimport { AppState, useAppDispatch } from \"../../../../store\";\nimport { setModalSnackMessage } from \"../../../../systemSlice\";\nimport MainError from \"../MainError/MainError\";\n\ninterface IModalProps {\n  onClose: () => void;\n  modalOpen: boolean;\n  title: string | React.ReactNode;\n  children: any;\n  wideLimit?: boolean;\n  titleIcon?: React.ReactNode;\n  iconColor?: \"default\" | \"delete\" | \"accept\";\n  sx?: CSSObject;\n}\n\nconst ModalWrapper = ({\n  onClose,\n  modalOpen,\n  title,\n  children,\n  wideLimit = true,\n  titleIcon = null,\n  iconColor = \"default\",\n  sx,\n}: IModalProps) => {\n  const dispatch = useAppDispatch();\n  const [openSnackbar, setOpenSnackbar] = useState<boolean>(false);\n\n  const modalSnackMessage = useSelector(\n    (state: AppState) => state.system.modalSnackBar,\n  );\n\n  useEffect(() => {\n    dispatch(setModalSnackMessage(\"\"));\n  }, [dispatch]);\n\n  useEffect(() => {\n    if (modalSnackMessage) {\n      if (modalSnackMessage.message === \"\") {\n        setOpenSnackbar(false);\n        return;\n      }\n      // Open SnackBar\n      if (modalSnackMessage.type !== \"error\") {\n        setOpenSnackbar(true);\n      }\n    }\n  }, [modalSnackMessage]);\n\n  const closeSnackBar = () => {\n    setOpenSnackbar(false);\n    dispatch(setModalSnackMessage(\"\"));\n  };\n\n  let message = \"\";\n\n  if (modalSnackMessage) {\n    message = modalSnackMessage.detailedErrorMsg;\n    if (message === \"\" || (message && message.length < 5)) {\n      message = modalSnackMessage.message;\n    }\n  }\n\n  return (\n    <ModalBox\n      onClose={onClose}\n      open={modalOpen}\n      title={title}\n      titleIcon={titleIcon}\n      widthLimit={wideLimit}\n      sx={sx}\n      iconColor={iconColor}\n    >\n      <MainError isModal={true} />\n      <Snackbar\n        onClose={closeSnackBar}\n        open={openSnackbar}\n        message={message}\n        mode={\"inline\"}\n        variant={modalSnackMessage.type === \"error\" ? \"error\" : \"default\"}\n        autoHideDuration={modalSnackMessage.type === \"error\" ? 10 : 5}\n        condensed\n      />\n      {children}\n    </ModalBox>\n  );\n};\n\nexport default ModalWrapper;\n"],"names":["_ref","open","bucketName","closeModalAndRefresh","dispatch","useAppDispatch","addLoading","setAddLoading","useState","loadingForm","setLoadingForm","retentionMode","setRetentionMode","ObjectRetentionMode","Compliance","retentionUnit","setRetentionUnit","ObjectRetentionUnit","Days","retentionValidity","setRetentionValidity","valid","setValid","useEffect","Number","isNaN","api","buckets","getBucketRetentionConfig","then","res","data","mode","validity","unit","catch","_jsx","ModalWrapper","title","modalOpen","onClose","children","Loader","style","width","height","noValidate","autoComplete","onSubmit","e","preventDefault","setBucketRetentionConfig","err","setModalErrorSnackMessage","errorToHandler","error","_jsxs","FormLayout","containerPadding","withBorders","RadioGroup","currentValue","id","name","label","onChange","target","value","selectorOptions","helpTip","Fragment","href","helpTipPlacement","InputBox","type","valueAsNumber","String","required","min","Grid","item","xs","sx","modalStyleUtils","modalButtonBar","Button","variant","disabled","onClick","color","ProgressBar","wideLimit","titleIcon","iconColor","openSnackbar","setOpenSnackbar","modalSnackMessage","useSelector","state","system","modalSnackBar","setModalSnackMessage","message","detailedErrorMsg","length","ModalBox","widthLimit","MainError","isModal","Snackbar","closeSnackBar","autoHideDuration","condensed"],"sourceRoot":""}