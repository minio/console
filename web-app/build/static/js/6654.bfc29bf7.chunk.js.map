{"version":3,"file":"static/js/6654.bfc29bf7.chunk.js","mappings":"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","sources":["screens/Console/Buckets/BucketDetails/AddKeyModal.tsx","screens/Console/Buckets/BucketDetails/EnableBucketEncryption.tsx","screens/Console/Common/ModalWrapper/ModalWrapper.tsx","screens/Console/KMS/KMSHelpbox.tsx"],"sourcesContent":["// This file is part of MinIO Console Server\n// Copyright (c) 2022 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React, { Fragment, useState } from \"react\";\nimport { Grid, InputBox } from \"mds\";\nimport { useAppDispatch } from \"../../../../store\";\nimport { setErrorSnackMessage } from \"../../../../systemSlice\";\nimport ConfirmDialog from \"../../Common/ModalWrapper/ConfirmDialog\";\nimport KMSHelpBox from \"../../KMS/KMSHelpbox\";\nimport { api } from \"api\";\nimport { ApiError, HttpResponse } from \"api/consoleApi\";\nimport { errorToHandler } from \"api/errors\";\n\ninterface IAddKeyModalProps {\n  closeAddModalAndRefresh: (refresh: boolean) => void;\n  addOpen: boolean;\n}\n\nconst AddKeyModal = ({\n  closeAddModalAndRefresh,\n  addOpen,\n}: IAddKeyModalProps) => {\n  const dispatch = useAppDispatch();\n  const onClose = () => closeAddModalAndRefresh(false);\n\n  const [loadingAdd, setLoadingAdd] = useState<boolean>(false);\n  const [keyName, setKeyName] = useState<string>(\"\");\n\n  const onConfirmAdd = () => {\n    setLoadingAdd(true);\n    api.kms\n      .kmsCreateKey({ key: keyName })\n      .then((_) => {\n        closeAddModalAndRefresh(true);\n      })\n      .catch(async (res: HttpResponse<void, ApiError>) => {\n        const err = (await res.json()) as ApiError;\n        dispatch(setErrorSnackMessage(errorToHandler(err)));\n        closeAddModalAndRefresh(false);\n      })\n      .finally(() => setLoadingAdd(false));\n  };\n\n  return (\n    <ConfirmDialog\n      title={\"\"}\n      confirmText={\"Create\"}\n      isOpen={addOpen}\n      isLoading={loadingAdd}\n      onConfirm={onConfirmAdd}\n      onClose={onClose}\n      confirmButtonProps={{\n        disabled: keyName.indexOf(\" \") !== -1 || keyName === \"\" || loadingAdd,\n        variant: \"callAction\",\n      }}\n      confirmationContent={\n        <Fragment>\n          <KMSHelpBox\n            helpText={\"Create Key\"}\n            contents={[\n              \"Create a new cryptographic key in the Key Management Service server connected to MINIO.\",\n            ]}\n          />\n\n          <Grid item xs={12} sx={{ marginTop: 15 }}>\n            <InputBox\n              id=\"key-name\"\n              name=\"key-name\"\n              label=\"Key Name\"\n              autoFocus={true}\n              value={keyName}\n              error={\n                keyName.indexOf(\" \") !== -1\n                  ? \"Key name cannot contain spaces\"\n                  : \"\"\n              }\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setKeyName(e.target.value);\n              }}\n            />\n          </Grid>\n        </Fragment>\n      }\n    />\n  );\n};\n\nexport default AddKeyModal;\n","// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React, { Fragment, useEffect, useState } from \"react\";\n\nimport {\n  AddIcon,\n  Box,\n  BucketEncryptionIcon,\n  Button,\n  FormLayout,\n  Grid,\n  ProgressBar,\n  Select,\n} from \"mds\";\nimport {\n  ApiError,\n  BucketEncryptionInfo,\n  BucketEncryptionType,\n  KmsKeyInfo,\n} from \"api/consoleApi\";\nimport { api } from \"api\";\nimport { errorToHandler } from \"api/errors\";\nimport { modalStyleUtils } from \"../../Common/FormComponents/common/styleLibrary\";\nimport { setModalErrorSnackMessage } from \"../../../../systemSlice\";\nimport { useAppDispatch } from \"../../../../store\";\nimport {\n  CONSOLE_UI_RESOURCE,\n  IAM_SCOPES,\n} from \"../../../../common/SecureComponent/permissions\";\nimport { SecureComponent } from \"../../../../common/SecureComponent\";\nimport TooltipWrapper from \"../../Common/TooltipWrapper/TooltipWrapper\";\nimport AddKeyModal from \"./AddKeyModal\";\nimport ModalWrapper from \"../../Common/ModalWrapper/ModalWrapper\";\n\ninterface IEnableBucketEncryptionProps {\n  open: boolean;\n  encryptionEnabled: boolean;\n  encryptionCfg: BucketEncryptionInfo | null;\n  selectedBucket: string;\n  closeModalAndRefresh: () => void;\n}\n\nconst EnableBucketEncryption = ({\n  open,\n  encryptionCfg,\n  selectedBucket,\n  closeModalAndRefresh,\n}: IEnableBucketEncryptionProps) => {\n  const dispatch = useAppDispatch();\n  const [loading, setLoading] = useState<boolean>(false);\n  const [kmsKeyID, setKmsKeyID] = useState<string>(\"\");\n  const [encryptionType, setEncryptionType] = useState<\n    BucketEncryptionType | \"disabled\"\n  >(\"disabled\");\n  const [keys, setKeys] = useState<KmsKeyInfo[] | undefined>([]);\n  const [loadingKeys, setLoadingKeys] = useState<boolean>(false);\n  const [addOpen, setAddOpen] = useState<boolean>(false);\n\n  useEffect(() => {\n    if (encryptionCfg) {\n      if (encryptionCfg.algorithm === \"AES256\") {\n        setEncryptionType(BucketEncryptionType.SseS3);\n      } else {\n        setEncryptionType(BucketEncryptionType.SseKms);\n        setKmsKeyID(encryptionCfg.kmsMasterKeyID || \"\");\n      }\n    }\n  }, [encryptionCfg]);\n\n  useEffect(() => {\n    if (encryptionType === \"sse-kms\") {\n      api.kms\n        .kmsListKeys()\n        .then((res) => {\n          setKeys(res.data.results);\n          setLoadingKeys(false);\n        })\n        .catch((err) => {\n          setLoadingKeys(false);\n          dispatch(setModalErrorSnackMessage(errorToHandler(err.error)));\n        });\n    }\n  }, [encryptionType, loadingKeys, dispatch]);\n\n  const enableBucketEncryption = (event: React.FormEvent) => {\n    event.preventDefault();\n    if (loading) {\n      return;\n    }\n    if (encryptionType === \"disabled\") {\n      api.buckets\n        .disableBucketEncryption(selectedBucket)\n        .then(() => {\n          setLoading(false);\n          closeModalAndRefresh();\n        })\n        .catch(async (res) => {\n          const err = (await res.json()) as ApiError;\n          setLoading(false);\n          dispatch(setModalErrorSnackMessage(errorToHandler(err)));\n        });\n    } else {\n      api.buckets\n        .enableBucketEncryption(selectedBucket, {\n          encType: encryptionType,\n          kmsKeyID: kmsKeyID,\n        })\n        .then(() => {\n          setLoading(false);\n          closeModalAndRefresh();\n        })\n\n        .catch(async (res) => {\n          const err = (await res.json()) as ApiError;\n          setLoading(false);\n          dispatch(setModalErrorSnackMessage(errorToHandler(err)));\n        });\n    }\n  };\n\n  return (\n    <Fragment>\n      {addOpen && (\n        <AddKeyModal\n          addOpen={addOpen}\n          closeAddModalAndRefresh={(refresh: boolean) => {\n            setAddOpen(false);\n            setLoadingKeys(true);\n          }}\n        />\n      )}\n\n      <ModalWrapper\n        modalOpen={open}\n        onClose={() => {\n          closeModalAndRefresh();\n        }}\n        title=\"Enable Bucket Encryption\"\n        titleIcon={<BucketEncryptionIcon />}\n      >\n        <form\n          noValidate\n          autoComplete=\"off\"\n          onSubmit={(e: React.FormEvent<HTMLFormElement>) => {\n            enableBucketEncryption(e);\n          }}\n        >\n          <FormLayout withBorders={false} containerPadding={false}>\n            <Select\n              onChange={(value) => {\n                setEncryptionType(value as BucketEncryptionType | \"disabled\");\n              }}\n              id=\"select-encryption-type\"\n              name=\"select-encryption-type\"\n              label={\"Encryption Type\"}\n              value={encryptionType}\n              options={[\n                {\n                  label: \"Disabled\",\n                  value: \"disabled\",\n                },\n                {\n                  label: \"SSE-S3\",\n                  value: BucketEncryptionType.SseS3,\n                },\n                {\n                  label: \"SSE-KMS\",\n                  value: BucketEncryptionType.SseKms,\n                },\n              ]}\n            />\n            {encryptionType === \"sse-kms\" && (\n              <Box sx={{ display: \"flex\", gap: 10 }} className={\"inputItem\"}>\n                {keys && (\n                  <Select\n                    onChange={(value) => {\n                      setKmsKeyID(value);\n                    }}\n                    id=\"select-kms-key-id\"\n                    name=\"select-kms-key-id\"\n                    label={\"KMS Key ID\"}\n                    value={kmsKeyID}\n                    options={keys.map((key: KmsKeyInfo) => {\n                      return {\n                        label: key.name || \"\",\n                        value: key.name || \"\",\n                      };\n                    })}\n                  />\n                )}\n                <SecureComponent\n                  scopes={[IAM_SCOPES.KMS_IMPORT_KEY]}\n                  resource={CONSOLE_UI_RESOURCE}\n                  errorProps={{ disabled: true }}\n                >\n                  <TooltipWrapper tooltip={\"Add key\"}>\n                    <Button\n                      id={\"import-key\"}\n                      variant={\"regular\"}\n                      icon={<AddIcon />}\n                      onClick={(e) => {\n                        setAddOpen(true);\n                        e.preventDefault();\n                      }}\n                    />\n                  </TooltipWrapper>\n                </SecureComponent>\n              </Box>\n            )}\n            <Grid item xs={12} sx={modalStyleUtils.modalButtonBar}>\n              <Button\n                id={\"cancel\"}\n                type=\"submit\"\n                variant=\"regular\"\n                onClick={() => {\n                  closeModalAndRefresh();\n                }}\n                disabled={loading}\n                label={\"Cancel\"}\n              />\n              <Button\n                id={\"save\"}\n                type=\"submit\"\n                variant=\"callAction\"\n                disabled={loading}\n                label={\"Save\"}\n              />\n            </Grid>\n            {loading && (\n              <Grid item xs={12}>\n                <ProgressBar />\n              </Grid>\n            )}\n          </FormLayout>\n        </form>\n      </ModalWrapper>\n    </Fragment>\n  );\n};\n\nexport default EnableBucketEncryption;\n","// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\nimport React, { useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { ModalBox, Snackbar } from \"mds\";\nimport { CSSObject } from \"styled-components\";\nimport { AppState, useAppDispatch } from \"../../../../store\";\nimport { setModalSnackMessage } from \"../../../../systemSlice\";\nimport MainError from \"../MainError/MainError\";\n\ninterface IModalProps {\n  onClose: () => void;\n  modalOpen: boolean;\n  title: string | React.ReactNode;\n  children: any;\n  wideLimit?: boolean;\n  titleIcon?: React.ReactNode;\n  iconColor?: \"default\" | \"delete\" | \"accept\";\n  sx?: CSSObject;\n}\n\nconst ModalWrapper = ({\n  onClose,\n  modalOpen,\n  title,\n  children,\n  wideLimit = true,\n  titleIcon = null,\n  iconColor = \"default\",\n  sx,\n}: IModalProps) => {\n  const dispatch = useAppDispatch();\n  const [openSnackbar, setOpenSnackbar] = useState<boolean>(false);\n\n  const modalSnackMessage = useSelector(\n    (state: AppState) => state.system.modalSnackBar,\n  );\n\n  useEffect(() => {\n    dispatch(setModalSnackMessage(\"\"));\n  }, [dispatch]);\n\n  useEffect(() => {\n    if (modalSnackMessage) {\n      if (modalSnackMessage.message === \"\") {\n        setOpenSnackbar(false);\n        return;\n      }\n      // Open SnackBar\n      if (modalSnackMessage.type !== \"error\") {\n        setOpenSnackbar(true);\n      }\n    }\n  }, [modalSnackMessage]);\n\n  const closeSnackBar = () => {\n    setOpenSnackbar(false);\n    dispatch(setModalSnackMessage(\"\"));\n  };\n\n  let message = \"\";\n\n  if (modalSnackMessage) {\n    message = modalSnackMessage.detailedErrorMsg;\n    if (message === \"\" || (message && message.length < 5)) {\n      message = modalSnackMessage.message;\n    }\n  }\n\n  return (\n    <ModalBox\n      onClose={onClose}\n      open={modalOpen}\n      title={title}\n      titleIcon={titleIcon}\n      widthLimit={wideLimit}\n      sx={sx}\n      iconColor={iconColor}\n    >\n      <MainError isModal={true} />\n      <Snackbar\n        onClose={closeSnackBar}\n        open={openSnackbar}\n        message={message}\n        mode={\"inline\"}\n        variant={modalSnackMessage.type === \"error\" ? \"error\" : \"default\"}\n        autoHideDuration={modalSnackMessage.type === \"error\" ? 10 : 5}\n        condensed\n      />\n      {children}\n    </ModalBox>\n  );\n};\n\nexport default ModalWrapper;\n","// This file is part of MinIO Console Server\n// Copyright (c) 2023 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React, { Fragment } from \"react\";\nimport { HelpBox, HelpIconFilled, Box } from \"mds\";\n\ninterface IKMSHelpBoxProps {\n  helpText: string;\n  contents: string[];\n}\n\nconst KMSHelpBox = ({ helpText, contents }: IKMSHelpBoxProps) => {\n  return (\n    <HelpBox\n      iconComponent={<HelpIconFilled />}\n      title={helpText}\n      help={\n        <Fragment>\n          {contents.map((content) => (\n            <Box sx={{ paddingBottom: \"20px\" }}>{content}</Box>\n          ))}\n        </Fragment>\n      }\n    />\n  );\n};\n\nexport default KMSHelpBox;\n"],"names":["_ref","closeAddModalAndRefresh","addOpen","dispatch","useAppDispatch","loadingAdd","setLoadingAdd","useState","keyName","setKeyName","_jsx","ConfirmDialog","title","confirmText","isOpen","isLoading","onConfirm","onConfirmAdd","api","kms","kmsCreateKey","key","then","_","catch","async","err","res","json","setErrorSnackMessage","errorToHandler","finally","onClose","confirmButtonProps","disabled","indexOf","variant","confirmationContent","_jsxs","Fragment","children","KMSHelpBox","helpText","contents","Grid","item","xs","sx","marginTop","InputBox","id","name","label","autoFocus","value","error","onChange","e","target","open","encryptionCfg","selectedBucket","closeModalAndRefresh","loading","setLoading","kmsKeyID","setKmsKeyID","encryptionType","setEncryptionType","keys","setKeys","loadingKeys","setLoadingKeys","setAddOpen","useEffect","algorithm","BucketEncryptionType","SseS3","SseKms","kmsMasterKeyID","kmsListKeys","data","results","setModalErrorSnackMessage","AddKeyModal","refresh","ModalWrapper","modalOpen","titleIcon","BucketEncryptionIcon","noValidate","autoComplete","onSubmit","preventDefault","buckets","disableBucketEncryption","enableBucketEncryption","encType","FormLayout","withBorders","containerPadding","Select","options","Box","display","gap","className","map","SecureComponent","scopes","IAM_SCOPES","KMS_IMPORT_KEY","resource","CONSOLE_UI_RESOURCE","errorProps","TooltipWrapper","tooltip","Button","icon","AddIcon","onClick","modalStyleUtils","modalButtonBar","type","ProgressBar","wideLimit","iconColor","openSnackbar","setOpenSnackbar","modalSnackMessage","useSelector","state","system","modalSnackBar","setModalSnackMessage","message","detailedErrorMsg","length","ModalBox","widthLimit","MainError","isModal","Snackbar","closeSnackBar","mode","autoHideDuration","condensed","HelpBox","iconComponent","HelpIconFilled","help","content","paddingBottom"],"sourceRoot":""}