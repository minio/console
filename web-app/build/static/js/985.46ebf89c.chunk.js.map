{"version":3,"file":"static/js/985.46ebf89c.chunk.js","mappings":"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","sources":["screens/Console/Policies/ListPolicies.tsx"],"sourcesContent":["// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React, { Fragment, useEffect, useState } from \"react\";\nimport {\n  AddIcon,\n  Button,\n  DataTable,\n  Grid,\n  HelpBox,\n  IAMPoliciesIcon,\n  PageLayout,\n} from \"mds\";\nimport { useNavigate } from \"react-router-dom\";\nimport { actionsTray } from \"../Common/FormComponents/common/styleLibrary\";\nimport { ErrorResponseHandler } from \"../../../common/types\";\nimport {\n  CONSOLE_UI_RESOURCE,\n  createPolicyPermissions,\n  deletePolicyPermissions,\n  IAM_PAGES,\n  IAM_SCOPES,\n  listPolicyPermissions,\n  permissionTooltipHelper,\n  viewPolicyPermissions,\n} from \"../../../common/SecureComponent/permissions\";\nimport {\n  hasPermission,\n  SecureComponent,\n} from \"../../../common/SecureComponent\";\nimport { Policy } from \"../../../api/consoleApi\";\nimport { setErrorSnackMessage, setHelpName } from \"../../../systemSlice\";\nimport { useAppDispatch } from \"../../../store\";\nimport { api } from \"../../../api\";\nimport SearchBox from \"../Common/SearchBox\";\nimport withSuspense from \"../Common/Components/withSuspense\";\nimport TooltipWrapper from \"../Common/TooltipWrapper/TooltipWrapper\";\nimport PageHeaderWrapper from \"../Common/PageHeaderWrapper/PageHeaderWrapper\";\nimport HelpMenu from \"../HelpMenu\";\n\nconst DeletePolicy = withSuspense(React.lazy(() => import(\"./DeletePolicy\")));\n\nconst ListPolicies = () => {\n  const dispatch = useAppDispatch();\n  const navigate = useNavigate();\n\n  const [records, setRecords] = useState<Policy[]>([]);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [deleteOpen, setDeleteOpen] = useState<boolean>(false);\n  const [selectedPolicy, setSelectedPolicy] = useState<string>(\"\");\n  const [filterPolicies, setFilterPolicies] = useState<string>(\"\");\n  const viewPolicy = hasPermission(CONSOLE_UI_RESOURCE, [\n    IAM_SCOPES.ADMIN_GET_POLICY,\n  ]);\n\n  const canDeletePolicy = hasPermission(\n    CONSOLE_UI_RESOURCE,\n    deletePolicyPermissions,\n  );\n\n  const canDisplayPolicies = hasPermission(\n    CONSOLE_UI_RESOURCE,\n    listPolicyPermissions,\n  );\n\n  const canCreatePolicy = hasPermission(\n    CONSOLE_UI_RESOURCE,\n    createPolicyPermissions,\n  );\n\n  const canViewPolicy = hasPermission(\n    CONSOLE_UI_RESOURCE,\n    viewPolicyPermissions,\n  );\n\n  useEffect(() => {\n    fetchRecords();\n  }, []);\n\n  useEffect(() => {\n    if (loading) {\n      if (canDisplayPolicies) {\n        api.policies\n          .listPolicies()\n          .then((res) => {\n            const policies = res.data.policies ?? [];\n\n            policies.sort((pa, pb) => {\n              if (pa.name! > pb.name!) {\n                return 1;\n              }\n\n              if (pa.name! < pb.name!) {\n                return -1;\n              }\n\n              return 0;\n            });\n\n            setLoading(false);\n            setRecords(policies);\n          })\n          .catch((err: ErrorResponseHandler) => {\n            setLoading(false);\n            dispatch(setErrorSnackMessage(err));\n          });\n      } else {\n        setLoading(false);\n      }\n    }\n  }, [loading, setLoading, setRecords, dispatch, canDisplayPolicies]);\n\n  const fetchRecords = () => {\n    setLoading(true);\n  };\n\n  const closeDeleteModalAndRefresh = (refresh: boolean) => {\n    setDeleteOpen(false);\n\n    if (refresh) {\n      fetchRecords();\n    }\n  };\n\n  const confirmDeletePolicy = (policy: string) => {\n    setDeleteOpen(true);\n    setSelectedPolicy(policy);\n  };\n\n  const viewAction = (policy: any) => {\n    navigate(`${IAM_PAGES.POLICIES}/${encodeURIComponent(policy.name)}`);\n  };\n\n  const tableActions = [\n    {\n      type: \"view\",\n      onClick: viewAction,\n      disableButtonFunction: () => !viewPolicy,\n    },\n    {\n      type: \"delete\",\n      onClick: confirmDeletePolicy,\n      sendOnlyId: true,\n      disableButtonFunction: () => !canDeletePolicy,\n    },\n  ];\n\n  const filteredRecords = records.filter((elementItem) =>\n    elementItem.name?.includes(filterPolicies),\n  );\n\n  useEffect(() => {\n    dispatch(setHelpName(\"list_policies\"));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <Fragment>\n      {deleteOpen && (\n        <DeletePolicy\n          deleteOpen={deleteOpen}\n          selectedPolicy={selectedPolicy}\n          closeDeleteModalAndRefresh={closeDeleteModalAndRefresh}\n        />\n      )}\n      <PageHeaderWrapper label=\"IAM Policies\" actions={<HelpMenu />} />\n\n      <PageLayout>\n        <Grid container>\n          <Grid item xs={12} sx={actionsTray.actionsTray}>\n            <SearchBox\n              onChange={setFilterPolicies}\n              placeholder=\"Search Policies\"\n              value={filterPolicies}\n              sx={{ maxWidth: 380 }}\n            />\n\n            <SecureComponent\n              scopes={[IAM_SCOPES.ADMIN_CREATE_POLICY]}\n              resource={CONSOLE_UI_RESOURCE}\n              errorProps={{ disabled: true }}\n            >\n              <TooltipWrapper\n                tooltip={\n                  canCreatePolicy\n                    ? \"\"\n                    : permissionTooltipHelper(\n                        createPolicyPermissions,\n                        \"create a Policy\",\n                      )\n                }\n              >\n                <Button\n                  id={\"create-policy\"}\n                  label={\"Create Policy\"}\n                  variant=\"callAction\"\n                  icon={<AddIcon />}\n                  onClick={() => {\n                    navigate(`${IAM_PAGES.POLICY_ADD}`);\n                  }}\n                  disabled={!canCreatePolicy}\n                />\n              </TooltipWrapper>\n            </SecureComponent>\n          </Grid>\n          <Grid item xs={12}>\n            <SecureComponent\n              scopes={[IAM_SCOPES.ADMIN_LIST_USER_POLICIES]}\n              resource={CONSOLE_UI_RESOURCE}\n              errorProps={{ disabled: true }}\n            >\n              <TooltipWrapper\n                tooltip={\n                  canViewPolicy\n                    ? \"\"\n                    : permissionTooltipHelper(\n                        viewPolicyPermissions,\n                        \"view Policy details\",\n                      )\n                }\n              >\n                <DataTable\n                  itemActions={tableActions}\n                  columns={[{ label: \"Name\", elementKey: \"name\" }]}\n                  isLoading={loading}\n                  records={filteredRecords}\n                  entityName=\"Policies\"\n                  idField=\"name\"\n                />\n              </TooltipWrapper>\n            </SecureComponent>\n          </Grid>\n          <Grid item xs={12} sx={{ marginTop: 15 }}>\n            <HelpBox\n              title={\"Learn more about IAM POLICIES\"}\n              iconComponent={<IAMPoliciesIcon />}\n              help={\n                <Fragment>\n                  MinIO uses Policy-Based Access Control (PBAC) to define the\n                  authorized actions and resources to which an authenticated\n                  user has access. Each policy describes one or more actions and\n                  conditions that outline the permissions of a user or group of\n                  users.\n                  <br />\n                  <br />\n                  MinIO PBAC is built for compatibility with AWS IAM policy\n                  syntax, structure, and behavior. The MinIO documentation makes\n                  a best-effort to cover IAM-specific behavior and\n                  functionality. Consider deferring to the IAM documentation for\n                  more complete documentation on AWS IAM-specific topics.\n                  <br />\n                  <br />\n                  You can learn more at our{\" \"}\n                  <a\n                    href=\"https://min.io/docs/minio/linux/administration/identity-access-management.html?ref=con#access-management\"\n                    target=\"_blank\"\n                    rel=\"noopener\"\n                  >\n                    documentation\n                  </a>\n                  .\n                </Fragment>\n              }\n            />\n          </Grid>\n        </Grid>\n      </PageLayout>\n    </Fragment>\n  );\n};\n\nexport default ListPolicies;\n"],"names":["DeletePolicy","withSuspense","React","ListPolicies","dispatch","useAppDispatch","navigate","useNavigate","records","setRecords","useState","loading","setLoading","deleteOpen","setDeleteOpen","selectedPolicy","setSelectedPolicy","filterPolicies","setFilterPolicies","viewPolicy","hasPermission","CONSOLE_UI_RESOURCE","IAM_SCOPES","ADMIN_GET_POLICY","canDeletePolicy","deletePolicyPermissions","canDisplayPolicies","listPolicyPermissions","canCreatePolicy","createPolicyPermissions","canViewPolicy","viewPolicyPermissions","useEffect","fetchRecords","api","policies","listPolicies","then","res","_res$data$policies","data","sort","pa","pb","name","catch","err","setErrorSnackMessage","tableActions","type","onClick","policy","IAM_PAGES","POLICIES","encodeURIComponent","disableButtonFunction","sendOnlyId","filteredRecords","filter","elementItem","_elementItem$name","includes","setHelpName","_jsxs","Fragment","children","_jsx","closeDeleteModalAndRefresh","refresh","PageHeaderWrapper","label","actions","HelpMenu","PageLayout","Grid","container","item","xs","sx","actionsTray","SearchBox","onChange","placeholder","value","maxWidth","SecureComponent","scopes","ADMIN_CREATE_POLICY","resource","errorProps","disabled","TooltipWrapper","tooltip","permissionTooltipHelper","Button","id","variant","icon","AddIcon","POLICY_ADD","ADMIN_LIST_USER_POLICIES","DataTable","itemActions","columns","elementKey","isLoading","entityName","idField","marginTop","HelpBox","title","iconComponent","IAMPoliciesIcon","help","href","target","rel"],"sourceRoot":""}