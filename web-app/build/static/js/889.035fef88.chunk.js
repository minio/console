"use strict";(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[889],{20889:(e,t,a)=>{a.r(t),a.d(t,{default:()=>v});var n=a(72791),l=a(26181),r=a.n(l),s=a(29945),i=a(31776),o=a(82342),c=a(23814),d=a(45248),u=a(87995),g=a(44690),h=a(56028),p=a(17420),x=a(84741),m=a(80184);const v=e=>{let{open:t,closeModalAndRefresh:a,bucketName:l,setReplicationRules:v}=e;const b=(0,g.TL)(),[y,j]=(0,n.useState)(!1),[S,f]=(0,n.useState)("1"),[C,k]=(0,n.useState)(""),[R,B]=(0,n.useState)(""),[z,I]=(0,n.useState)(""),[D,w]=(0,n.useState)(""),[E,T]=(0,n.useState)(""),[A,M]=(0,n.useState)(""),[W,L]=(0,n.useState)(""),[P,K]=(0,n.useState)(!0),[N,Z]=(0,n.useState)(!0),[U,_]=(0,n.useState)(!0),[F,O]=(0,n.useState)(!0),[q,V]=(0,n.useState)(""),[Y,G]=(0,n.useState)("async"),[H,Q]=(0,n.useState)("100"),[J,X]=(0,n.useState)("Gi"),[$,ee]=(0,n.useState)("60");(0,n.useEffect)((()=>{if(0===v.length)return void f("1");const e=v.reduce(((e,t)=>t.priority>e?t.priority:e),0);f((e+1).toString())}),[v]);return(0,m.jsx)(h.Z,{modalOpen:t,onClose:()=>{a()},title:"Set Bucket Replication",titleIcon:(0,m.jsx)(s.xRg,{}),children:(0,m.jsx)("form",{noValidate:!0,autoComplete:"off",onSubmit:e=>{e.preventDefault(),j(!0),(()=>{const e=[{originBucket:l,destinationBucket:A}],t=parseInt($),n="".concat(P?"https://":"http://").concat(z),s={accessKey:C,secretKey:R,targetURL:n,region:W,bucketsRelation:e,syncMode:Y,bandwidth:"async"===Y?parseInt((0,d.Pw)(H,J,!0)):0,healthCheckPeriod:t,prefix:E,tags:q,replicateDeleteMarkers:N,replicateDeletes:U,priority:parseInt(S),storageClass:D,replicateMetadata:F};i.h.bucketsReplication.setMultiBucketReplication(s).then((e=>{j(!1);const t=r()(e.data,"replicationState",[]);if(t.length>0){const e=t[0];return j(!1),e.errorString&&""!==e.errorString?void b((0,u.zb)({errorMessage:e.errorString,detailedError:""})):void a()}b((0,u.zb)({errorMessage:"No changes applied",detailedError:""}))})).catch((e=>{j(!1),b((0,u.zb)((0,o.g)(e.error)))}))})()},children:(0,m.jsxs)(s.ltY,{withBorders:!1,containerPadding:!1,children:[(0,m.jsx)(s.Wzg,{id:"priority",name:"priority",onChange:e=>{e.target.validity.valid&&f(e.target.value)},label:"Priority",value:S,pattern:"[0-9]*"}),(0,m.jsx)(s.Wzg,{id:"targetURL",name:"targetURL",onChange:e=>{I(e.target.value)},placeholder:"play.min.io",label:"Target URL",value:z}),(0,m.jsx)(s.rsf,{checked:P,id:"useTLS",name:"useTLS",label:"Use TLS",onChange:e=>{K(e.target.checked)},value:"yes"}),(0,m.jsx)(s.Wzg,{id:"accessKey",name:"accessKey",onChange:e=>{k(e.target.value)},label:"Access Key",value:C}),(0,m.jsx)(s.Wzg,{id:"secretKey",name:"secretKey",onChange:e=>{B(e.target.value)},label:"Secret Key",value:R}),(0,m.jsx)(s.Wzg,{id:"targetBucket",name:"targetBucket",onChange:e=>{M(e.target.value)},label:"Target Bucket",value:A}),(0,m.jsx)(s.Wzg,{id:"region",name:"region",onChange:e=>{L(e.target.value)},label:"Region",value:W}),(0,m.jsx)(s.PhF,{id:"replication_mode",name:"replication_mode",onChange:e=>{G(e)},label:"Replication Mode",value:Y,options:[{label:"Asynchronous",value:"async"},{label:"Synchronous",value:"sync"}]}),"async"===Y&&(0,m.jsx)(s.xuv,{className:"inputItem",children:(0,m.jsx)(s.Wzg,{type:"number",id:"bandwidth_scalar",name:"bandwidth_scalar",onChange:e=>{e.target.validity.valid&&Q(e.target.value)},label:"Bandwidth",value:H,min:"0",pattern:"[0-9]*",overlayObject:(0,m.jsx)(x.Z,{id:"quota_unit",onUnitChange:e=>{X(e)},unitSelected:J,unitsList:(0,d.zQ)(["Ki"]),disabled:!1})})}),(0,m.jsx)(s.Wzg,{id:"healthCheck",name:"healthCheck",onChange:e=>{ee(e.target.value)},label:"Health Check Duration",value:$}),(0,m.jsx)(s.Wzg,{id:"storageClass",name:"storageClass",onChange:e=>{w(e.target.value)},placeholder:"STANDARD_IA,REDUCED_REDUNDANCY etc",label:"Storage Class",value:D}),(0,m.jsxs)("fieldset",{className:"inputItem",children:[(0,m.jsx)("legend",{children:"Object Filters"}),(0,m.jsx)(s.Wzg,{id:"prefix",name:"prefix",onChange:e=>{T(e.target.value)},placeholder:"prefix",label:"Prefix",value:E}),(0,m.jsx)(p.Z,{name:"tags",label:"Tags",elements:"",onChange:e=>{V(e)},keyPlaceholder:"Tag Key",valuePlaceholder:"Tag Value",withBorder:!0})]}),(0,m.jsxs)("fieldset",{className:"inputItem",children:[(0,m.jsx)("legend",{children:"Replication Options"}),(0,m.jsx)(s.rsf,{checked:F,id:"metadatataSync",name:"metadatataSync",label:"Metadata Sync",onChange:e=>{O(e.target.checked)},description:"Metadata Sync"}),(0,m.jsx)(s.rsf,{checked:N,id:"deleteMarker",name:"deleteMarker",label:"Delete Marker",onChange:e=>{Z(e.target.checked)},description:"Replicate soft deletes"}),(0,m.jsx)(s.rsf,{checked:U,id:"repDelete",name:"repDelete",label:"Deletes",onChange:e=>{_(e.target.checked)},description:"Replicate versioned deletes"})]}),(0,m.jsxs)(s.rjZ,{item:!0,xs:12,sx:c.ID.modalButtonBar,children:[(0,m.jsx)(s.zxk,{id:"cancel",type:"button",variant:"regular",disabled:y,onClick:()=>{a()},label:"Cancel"}),(0,m.jsx)(s.zxk,{id:"submit",type:"submit",variant:"callAction",color:"primary",disabled:y,label:"Save"})]})]})})})}},84741:(e,t,a)=>{a.d(t,{Z:()=>d});var n=a(72791),l=a(29945),r=a(16444),s=a(26181),i=a.n(s),o=a(80184);const c=r.ZP.button((e=>{let{theme:t}=e;return{border:"1px solid ".concat(i()(t,"borderColor","#E2E2E2")),borderRadius:3,color:i()(t,"secondaryText","#5B5C5C"),backgroundColor:i()(t,"boxBackground","#FBFAFA"),fontSize:12}})),d=e=>{let{id:t,unitSelected:a,unitsList:r,disabled:s=!1,onUnitChange:i}=e;const[d,u]=n.useState(null),g=Boolean(d),h=e=>{u(null),""!==e&&i&&i(e)};return(0,o.jsxs)(n.Fragment,{children:[(0,o.jsx)(c,{id:"".concat(t,"-button"),"aria-controls":"".concat(t,"-menu"),"aria-haspopup":"true","aria-expanded":g?"true":void 0,onClick:e=>{u(e.currentTarget)},disabled:s,type:"button",children:a}),(0,o.jsx)(l.udT,{id:"upload-main-menu",options:r,selectedOption:"",onSelect:e=>h(e),hideTriggerAction:()=>{h("")},open:g,anchorEl:d,anchorOrigin:"end"})]})}},17420:(e,t,a)=>{a.d(t,{Z:()=>d});var n=a(72791),l=a(26181),r=a.n(l),s=a(48573),i=a.n(s),o=a(29945),c=a(80184);const d=e=>{let{elements:t,name:a,label:l,tooltip:s="",keyPlaceholder:d="",valuePlaceholder:u="",onChange:g,withBorder:h=!1}=e;const[p,x]=(0,n.useState)([""]),[m,v]=(0,n.useState)([""]),b=(0,n.createRef)();(0,n.useEffect)((()=>{if(1===p.length&&""===p[0]&&1===m.length&&""===m[0]&&t&&""!==t){const e=t.split("&");let a=[],n=[];e.forEach((e=>{const t=e.split("=");2===t.length&&(a.push(t[0]),n.push(t[1]))})),a.push(""),n.push(""),x(a),v(n)}}),[p,m,t]),(0,n.useEffect)((()=>{const e=b.current;e&&p.length>1&&e.scrollIntoView(!1)}),[p]);const y=(0,n.useRef)(!0);(0,n.useLayoutEffect)((()=>{y.current?y.current=!1:f()}),[p,m]);const j=e=>{e.persist();let t=[...p];const a=r()(e.target,"dataset.index","0");t[parseInt(a)]=e.target.value,x(t)},S=e=>{e.persist();let t=[...m];const a=r()(e.target,"dataset.index","0");t[parseInt(a)]=e.target.value,v(t)},f=i()((()=>{let e="";p.forEach(((t,a)=>{if(p[a]&&m[a]){let n="".concat(t,"=").concat(m[a]);0!==a&&(n="&".concat(n)),e="".concat(e).concat(n)}})),g(e)}),500),C=m.map(((e,t)=>(0,c.jsxs)(o.rjZ,{item:!0,xs:12,className:"lineInputBoxes inputItem",children:[(0,c.jsx)(o.Wzg,{id:"".concat(a,"-key-").concat(t.toString()),label:"",name:"".concat(a,"-").concat(t.toString()),value:p[t],onChange:j,index:t,placeholder:d}),(0,c.jsx)("span",{className:"queryDiv",children:":"}),(0,c.jsx)(o.Wzg,{id:"".concat(a,"-value-").concat(t.toString()),label:"",name:"".concat(a,"-").concat(t.toString()),value:m[t],onChange:S,index:t,placeholder:u,overlayIcon:t===m.length-1?(0,c.jsx)(o.dtP,{}):null,overlayAction:()=>{(()=>{if(""!==p[p.length-1].trim()&&""!==m[m.length-1].trim()){const e=[...p],t=[...m];e.push(""),t.push(""),x(e),v(t)}})()}})]},"query-pair-".concat(a,"-").concat(t.toString()))));return(0,c.jsx)(n.Fragment,{children:(0,c.jsxs)(o.rjZ,{item:!0,xs:12,sx:{"& .lineInputBoxes":{display:"flex"},"& .queryDiv":{alignSelf:"center",margin:"-15px 4px 0",fontWeight:600}},className:"inputItem",children:[(0,c.jsxs)(o.AZs,{children:[l,""!==s&&(0,c.jsx)(o.xuv,{sx:{marginLeft:5,display:"flex",alignItems:"center","& .min-icon":{width:13}},children:(0,c.jsx)(o.ua7,{tooltip:s,placement:"top",children:(0,c.jsx)(o.byK,{style:{width:13,height:13}})})})]}),(0,c.jsxs)(o.xuv,{withBorders:h,sx:{padding:15,height:150,overflowY:"auto",position:"relative",marginTop:15},children:[C,(0,c.jsx)("div",{ref:b})]})]})})}}}]);
//# sourceMappingURL=889.035fef88.chunk.js.map