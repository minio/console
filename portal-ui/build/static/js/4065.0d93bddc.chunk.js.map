{"version":3,"file":"static/js/4065.0d93bddc.chunk.js","mappings":"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","sources":["screens/Console/Account/ChangePasswordModal.tsx","screens/Console/Account/Account.tsx"],"sourcesContent":["// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React, { Fragment, useState } from \"react\";\nimport {\n  Button,\n  ChangePasswordIcon,\n  InputBox,\n  Grid,\n  FormLayout,\n  ProgressBar,\n  InformativeMessage,\n} from \"mds\";\nimport ModalWrapper from \"../Common/ModalWrapper/ModalWrapper\";\n\nimport { modalStyleUtils } from \"../Common/FormComponents/common/styleLibrary\";\nimport {\n  setErrorSnackMessage,\n  setModalErrorSnackMessage,\n  setSnackBarMessage,\n} from \"../../../systemSlice\";\nimport { useAppDispatch } from \"../../../store\";\nimport { api } from \"api\";\nimport { AccountChangePasswordRequest, ApiError } from \"api/consoleApi\";\nimport { errorToHandler } from \"api/errors\";\n\ninterface IChangePasswordProps {\n  open: boolean;\n  closeModal: () => void;\n}\n\nconst ChangePassword = ({ open, closeModal }: IChangePasswordProps) => {\n  const dispatch = useAppDispatch();\n  const [currentPassword, setCurrentPassword] = useState<string>(\"\");\n  const [newPassword, setNewPassword] = useState<string>(\"\");\n  const [reNewPassword, setReNewPassword] = useState<string>(\"\");\n  const [loading, setLoading] = useState<boolean>(false);\n\n  const userLoggedIn = localStorage.getItem(\"userLoggedIn\") || \"\";\n\n  const changePassword = (event: React.FormEvent) => {\n    event.preventDefault();\n\n    if (newPassword !== reNewPassword) {\n      dispatch(\n        setModalErrorSnackMessage({\n          errorMessage: \"New passwords don't match\",\n          detailedError: \"\",\n        }),\n      );\n      return;\n    }\n\n    if (newPassword.length < 8) {\n      dispatch(\n        setModalErrorSnackMessage({\n          errorMessage: \"Passwords must be at least 8 characters long\",\n          detailedError: \"\",\n        }),\n      );\n      return;\n    }\n\n    if (loading) {\n      return;\n    }\n    setLoading(true);\n\n    let request: AccountChangePasswordRequest = {\n      current_secret_key: currentPassword,\n      new_secret_key: newPassword,\n    };\n\n    api.account\n      .accountChangePassword(request)\n      .then(() => {\n        setLoading(false);\n        setNewPassword(\"\");\n        setReNewPassword(\"\");\n        setCurrentPassword(\"\");\n        dispatch(setSnackBarMessage(\"Successfully updated the password.\"));\n        closeModal();\n      })\n      .catch(async (res) => {\n        setLoading(false);\n        setNewPassword(\"\");\n        setReNewPassword(\"\");\n        setCurrentPassword(\"\");\n        const err = (await res.json()) as ApiError;\n        dispatch(setErrorSnackMessage(errorToHandler(err)));\n      });\n  };\n\n  return open ? (\n    <ModalWrapper\n      title={`Change Password for ${userLoggedIn}`}\n      modalOpen={open}\n      onClose={() => {\n        setNewPassword(\"\");\n        setReNewPassword(\"\");\n        setCurrentPassword(\"\");\n        closeModal();\n      }}\n      titleIcon={<ChangePasswordIcon />}\n    >\n      <div>\n        This will change your Console password. Please note your new password\n        down, as it will be required to log into Console after this session.\n      </div>\n      <InformativeMessage\n        variant={\"warning\"}\n        title={\"Warning\"}\n        message={\n          <Fragment>\n            If you are looking to change MINIO_ROOT_USER credentials, <br />\n            Please refer to{\" \"}\n            <a\n              target=\"_blank\"\n              rel=\"noopener\"\n              href=\"https://min.io/docs/minio/linux/administration/identity-access-management/minio-user-management.html#id4?ref=con\"\n            >\n              rotating\n            </a>{\" \"}\n            credentials.\n          </Fragment>\n        }\n        sx={{ margin: \"15px 0\" }}\n      />\n      <form\n        noValidate\n        autoComplete=\"off\"\n        onSubmit={(e: React.FormEvent<HTMLFormElement>) => {\n          changePassword(e);\n        }}\n      >\n        <Grid container>\n          <Grid item xs={12} sx={{ ...modalStyleUtils.modalFormScrollable }}>\n            <FormLayout withBorders={false} containerPadding={false}>\n              <InputBox\n                id=\"current-password\"\n                name=\"current-password\"\n                onChange={(event: React.ChangeEvent<HTMLInputElement>) => {\n                  setCurrentPassword(event.target.value);\n                }}\n                label=\"Current Password\"\n                type={\"password\"}\n                value={currentPassword}\n              />\n              <InputBox\n                id=\"new-password\"\n                name=\"new-password\"\n                onChange={(event: React.ChangeEvent<HTMLInputElement>) => {\n                  setNewPassword(event.target.value);\n                }}\n                label=\"New Password\"\n                type={\"password\"}\n                value={newPassword}\n              />\n              <InputBox\n                id=\"re-new-password\"\n                name=\"re-new-password\"\n                onChange={(event: React.ChangeEvent<HTMLInputElement>) => {\n                  setReNewPassword(event.target.value);\n                }}\n                label=\"Type New Password Again\"\n                type={\"password\"}\n                value={reNewPassword}\n              />\n            </FormLayout>\n          </Grid>\n          <Grid item xs={12} sx={{ ...modalStyleUtils.modalButtonBar }}>\n            <Button\n              id={\"save-password-modal\"}\n              type=\"submit\"\n              variant=\"callAction\"\n              color=\"primary\"\n              disabled={\n                loading ||\n                !(\n                  currentPassword.length > 0 &&\n                  newPassword.length > 0 &&\n                  reNewPassword.length > 0\n                )\n              }\n              label=\"Save\"\n            />\n          </Grid>\n          {loading && (\n            <Grid item xs={12}>\n              <ProgressBar />\n            </Grid>\n          )}\n        </Grid>\n      </form>\n    </ModalWrapper>\n  ) : null;\n};\n\nexport default ChangePassword;\n","// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React, { Fragment, useEffect, useState } from \"react\";\nimport {\n  AccountIcon,\n  AddIcon,\n  Box,\n  Button,\n  DataTable,\n  DeleteIcon,\n  Grid,\n  HelpBox,\n  PageLayout,\n  PasswordKeyIcon,\n} from \"mds\";\nimport { useSelector } from \"react-redux\";\nimport { useNavigate } from \"react-router-dom\";\nimport { actionsTray } from \"../Common/FormComponents/common/styleLibrary\";\n\nimport ChangePasswordModal from \"./ChangePasswordModal\";\nimport SearchBox from \"../Common/SearchBox\";\nimport withSuspense from \"../Common/Components/withSuspense\";\n\nimport { selectSAs } from \"../Configurations/utils\";\nimport DeleteMultipleServiceAccounts from \"../Users/DeleteMultipleServiceAccounts\";\nimport ServiceAccountPolicy from \"./ServiceAccountPolicy\";\n\nimport { selFeatures } from \"../consoleSlice\";\nimport TooltipWrapper from \"../Common/TooltipWrapper/TooltipWrapper\";\nimport PageHeaderWrapper from \"../Common/PageHeaderWrapper/PageHeaderWrapper\";\nimport { api } from \"api\";\nimport { errorToHandler } from \"api/errors\";\nimport HelpMenu from \"../HelpMenu\";\nimport { ACCOUNT_TABLE_COLUMNS } from \"./AccountUtils\";\nimport { useAppDispatch } from \"store\";\nimport { ServiceAccounts } from \"api/consoleApi\";\nimport {\n  setErrorSnackMessage,\n  setHelpName,\n  setSnackBarMessage,\n} from \"systemSlice\";\nimport { usersSort } from \"utils/sortFunctions\";\nimport { SecureComponent } from \"common/SecureComponent\";\nimport {\n  CONSOLE_UI_RESOURCE,\n  IAM_PAGES,\n  IAM_SCOPES,\n} from \"common/SecureComponent/permissions\";\n\nconst DeleteServiceAccount = withSuspense(\n  React.lazy(() => import(\"./DeleteServiceAccount\")),\n);\n\nconst Account = () => {\n  const dispatch = useAppDispatch();\n  const navigate = useNavigate();\n\n  const features = useSelector(selFeatures);\n\n  const [records, setRecords] = useState<ServiceAccounts>([]);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [filter, setFilter] = useState<string>(\"\");\n  const [deleteOpen, setDeleteOpen] = useState<boolean>(false);\n  const [selectedServiceAccount, setSelectedServiceAccount] = useState<\n    string | null\n  >(null);\n  const [changePasswordModalOpen, setChangePasswordModalOpen] =\n    useState<boolean>(false);\n  const [selectedSAs, setSelectedSAs] = useState<string[]>([]);\n  const [deleteMultipleOpen, setDeleteMultipleOpen] = useState<boolean>(false);\n  const [policyOpen, setPolicyOpen] = useState<boolean>(false);\n\n  const userIDP = (features && features.includes(\"external-idp\")) || false;\n\n  useEffect(() => {\n    fetchRecords();\n  }, []);\n\n  useEffect(() => {\n    dispatch(setHelpName(\"accessKeys\"));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    if (loading) {\n      api.serviceAccounts\n        .listUserServiceAccounts()\n        .then((res) => {\n          setLoading(false);\n          const sortedRows = res.data.sort(usersSort);\n          setRecords(sortedRows);\n        })\n        .catch((res) => {\n          dispatch(\n            setErrorSnackMessage(\n              errorToHandler(res?.error || \"Error retrieving access keys\"),\n            ),\n          );\n          setLoading(false);\n        });\n    }\n  }, [loading, setLoading, setRecords, dispatch]);\n\n  const fetchRecords = () => {\n    setLoading(true);\n  };\n\n  const closeDeleteModalAndRefresh = (refresh: boolean) => {\n    setDeleteOpen(false);\n\n    if (refresh) {\n      setSelectedSAs([]);\n      fetchRecords();\n    }\n  };\n\n  const closeDeleteMultipleModalAndRefresh = (refresh: boolean) => {\n    setDeleteMultipleOpen(false);\n    if (refresh) {\n      dispatch(setSnackBarMessage(`Access keys deleted successfully.`));\n      setSelectedSAs([]);\n      setLoading(true);\n    }\n  };\n\n  const policyModalOpen = (selectedServiceAccount: string) => {\n    setSelectedServiceAccount(selectedServiceAccount);\n    setPolicyOpen(true);\n  };\n\n  const closePolicyModal = () => {\n    setPolicyOpen(false);\n    setLoading(true);\n  };\n\n  const confirmDeleteServiceAccount = (selectedServiceAccount: string) => {\n    setSelectedServiceAccount(selectedServiceAccount);\n    setDeleteOpen(true);\n  };\n\n  const tableActions = [\n    {\n      type: \"view\",\n      onClick: (value: any) => {\n        if (value) {\n          policyModalOpen(value.accessKey);\n        }\n      },\n    },\n    {\n      type: \"delete\",\n      onClick: (value: any) => {\n        if (value) {\n          confirmDeleteServiceAccount(value.accessKey);\n        }\n      },\n    },\n  ];\n\n  const filteredRecords = records.filter(\n    (elementItem) =>\n      elementItem?.accessKey?.toLowerCase().includes(filter.toLowerCase()),\n  );\n\n  return (\n    <React.Fragment>\n      {deleteOpen && (\n        <DeleteServiceAccount\n          deleteOpen={deleteOpen}\n          selectedServiceAccount={selectedServiceAccount}\n          closeDeleteModalAndRefresh={(refresh: boolean) => {\n            closeDeleteModalAndRefresh(refresh);\n          }}\n        />\n      )}\n      {deleteMultipleOpen && (\n        <DeleteMultipleServiceAccounts\n          deleteOpen={deleteMultipleOpen}\n          selectedSAs={selectedSAs}\n          closeDeleteModalAndRefresh={closeDeleteMultipleModalAndRefresh}\n        />\n      )}\n\n      {policyOpen && (\n        <ServiceAccountPolicy\n          open={policyOpen}\n          selectedAccessKey={selectedServiceAccount}\n          closeModalAndRefresh={closePolicyModal}\n        />\n      )}\n      <ChangePasswordModal\n        open={changePasswordModalOpen}\n        closeModal={() => setChangePasswordModalOpen(false)}\n      />\n      <PageHeaderWrapper label=\"Access Keys\" actions={<HelpMenu />} />\n\n      <PageLayout>\n        <Grid container>\n          <Grid item xs={12} sx={{ ...actionsTray.actionsTray }}>\n            <SearchBox\n              placeholder={\"Search Access Keys\"}\n              onChange={setFilter}\n              sx={{ marginRight: \"auto\", maxWidth: 380 }}\n              value={filter}\n            />\n            <Box\n              sx={{\n                display: \"flex\",\n                flexWrap: \"nowrap\",\n                gap: 5,\n              }}\n            >\n              <TooltipWrapper tooltip={\"Delete Selected\"}>\n                <Button\n                  id={\"delete-selected-accounts\"}\n                  onClick={() => {\n                    setDeleteMultipleOpen(true);\n                  }}\n                  label={\"Delete Selected\"}\n                  icon={<DeleteIcon />}\n                  disabled={selectedSAs.length === 0}\n                  variant={\"secondary\"}\n                />\n              </TooltipWrapper>\n              <SecureComponent\n                scopes={[IAM_SCOPES.ADMIN_CREATE_USER]}\n                resource={CONSOLE_UI_RESOURCE}\n                matchAll\n                errorProps={{ disabled: true }}\n              >\n                <Button\n                  id={\"change-password\"}\n                  onClick={() => setChangePasswordModalOpen(true)}\n                  label={`Change Password`}\n                  icon={<PasswordKeyIcon />}\n                  variant={\"regular\"}\n                  disabled={userIDP}\n                />\n              </SecureComponent>\n              <SecureComponent\n                scopes={[IAM_SCOPES.ADMIN_CREATE_SERVICEACCOUNT]}\n                resource={CONSOLE_UI_RESOURCE}\n                matchAll\n                errorProps={{ disabled: true }}\n              >\n                <Button\n                  id={\"create-service-account\"}\n                  onClick={() => {\n                    navigate(`${IAM_PAGES.ACCOUNT_ADD}`);\n                  }}\n                  label={`Create access key`}\n                  icon={<AddIcon />}\n                  variant={\"callAction\"}\n                />\n              </SecureComponent>\n            </Box>\n          </Grid>\n\n          <Grid item xs={12}>\n            <DataTable\n              itemActions={tableActions}\n              entityName={\"Access Keys\"}\n              columns={ACCOUNT_TABLE_COLUMNS}\n              onSelect={(e) => selectSAs(e, setSelectedSAs, selectedSAs)}\n              selectedItems={selectedSAs}\n              isLoading={loading}\n              records={filteredRecords}\n              idField=\"accessKey\"\n            />\n          </Grid>\n          <Grid item xs={12} sx={{ marginTop: 15 }}>\n            <HelpBox\n              title={\"Learn more about ACCESS KEYS\"}\n              iconComponent={<AccountIcon />}\n              help={\n                <Fragment>\n                  MinIO access keys are child identities of an authenticated\n                  MinIO user, including externally managed identities. Each\n                  access key inherits its privileges based on the policies\n                  attached to itâ€™s parent user or those groups in which the\n                  parent user has membership. Access Keys also support an\n                  optional inline policy which further restricts access to a\n                  subset of actions and resources available to the parent user.\n                  <br />\n                  <br />\n                  You can learn more at our{\" \"}\n                  <a\n                    href=\"https://min.io/docs/minio/linux/administration/identity-access-management/minio-user-management.html?ref=con#id3\"\n                    target=\"_blank\"\n                    rel=\"noopener\"\n                  >\n                    documentation\n                  </a>\n                  .\n                </Fragment>\n              }\n            />\n          </Grid>\n        </Grid>\n      </PageLayout>\n    </React.Fragment>\n  );\n};\n\nexport default Account;\n"],"names":["_ref","open","closeModal","dispatch","useAppDispatch","_useState","useState","_useState2","_slicedToArray","currentPassword","setCurrentPassword","_useState3","_useState4","newPassword","setNewPassword","_useState5","_useState6","reNewPassword","setReNewPassword","_useState7","_useState8","loading","setLoading","userLoggedIn","localStorage","getItem","_jsxs","ModalWrapper","title","concat","modalOpen","onClose","titleIcon","_jsx","ChangePasswordIcon","children","InformativeMessage","variant","message","Fragment","target","rel","href","sx","margin","noValidate","autoComplete","onSubmit","e","event","preventDefault","length","setModalErrorSnackMessage","errorMessage","detailedError","request","current_secret_key","new_secret_key","api","account","accountChangePassword","then","setSnackBarMessage","catch","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","err","wrap","_context","prev","next","json","sent","setErrorSnackMessage","errorToHandler","stop","_x","apply","arguments","changePassword","Grid","container","item","xs","_objectSpread","modalStyleUtils","modalFormScrollable","FormLayout","withBorders","containerPadding","InputBox","id","name","onChange","value","label","type","modalButtonBar","Button","color","disabled","ProgressBar","DeleteServiceAccount","withSuspense","React","navigate","useNavigate","features","useSelector","selFeatures","records","setRecords","filter","setFilter","deleteOpen","setDeleteOpen","_useState9","_useState10","selectedServiceAccount","setSelectedServiceAccount","_useState11","_useState12","changePasswordModalOpen","setChangePasswordModalOpen","_useState13","_useState14","selectedSAs","setSelectedSAs","_useState15","_useState16","deleteMultipleOpen","setDeleteMultipleOpen","_useState17","_useState18","policyOpen","setPolicyOpen","userIDP","includes","useEffect","fetchRecords","setHelpName","serviceAccounts","listUserServiceAccounts","sortedRows","data","sort","usersSort","error","tableActions","onClick","policyModalOpen","accessKey","confirmDeleteServiceAccount","filteredRecords","elementItem","_elementItem$accessKe","toLowerCase","closeDeleteModalAndRefresh","refresh","DeleteMultipleServiceAccounts","ServiceAccountPolicy","selectedAccessKey","closeModalAndRefresh","ChangePasswordModal","PageHeaderWrapper","actions","HelpMenu","PageLayout","actionsTray","SearchBox","placeholder","marginRight","maxWidth","Box","display","flexWrap","gap","TooltipWrapper","tooltip","icon","DeleteIcon","SecureComponent","scopes","IAM_SCOPES","ADMIN_CREATE_USER","resource","CONSOLE_UI_RESOURCE","matchAll","errorProps","PasswordKeyIcon","ADMIN_CREATE_SERVICEACCOUNT","IAM_PAGES","ACCOUNT_ADD","AddIcon","DataTable","itemActions","entityName","columns","ACCOUNT_TABLE_COLUMNS","onSelect","selectSAs","selectedItems","isLoading","idField","marginTop","HelpBox","iconComponent","AccountIcon","help"],"sourceRoot":""}