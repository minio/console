"use strict";(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[9449],{99449:function(e,a,t){t.r(a),t.d(a,{default:function(){return w}});var n=t(29439),s=t(1413),i=t(72791),l=t(60364),r=t(11135),o=t(25787),c=t(61889),d=t(23814),u=t(51691),m=t(10703),h=t(42649),g=t(93433),x=t(56028),v=t(36151),Z=t(81207),j=t(32509),p=t(21435),C=t(40968),f=t(56578),N=t(80184),b=(0,o.Z)((function(e){return(0,r.Z)((0,s.Z)((0,s.Z)((0,s.Z)({buttonContainer:{textAlign:"right"}},d.oO),d.ID),d.DF))}))((function(e){e.tenant;var a=e.classes,t=e.open,s=e.onClose,l=e.image,r=e.sidecarImage,o=e.initImage,d=e.labels,u=e.annotations,m=e.nodeSelector,b=e.diskCapacityGB,S=e.serviceAccountName,I=e.storageClassName,A=e.tenantName,y=e.tenantNamespace,P=e.cpuRequest,R=e.memRequest,q=(0,i.useState)({}),k=(0,n.Z)(q,2),z=k[0],w=k[1],M=(0,i.useState)(d.length>0?(0,g.Z)(d):[{key:"",value:""}]),G=(0,n.Z)(M,2),F=G[0],E=G[1],B=(0,i.useState)(u.length>0?(0,g.Z)(u):[{key:"",value:""}]),L=(0,n.Z)(B,2),U=L[0],D=L[1],O=(0,i.useState)(m.length>0?(0,g.Z)(m):[{key:"",value:""}]),$=(0,n.Z)(O,2),_=$[0],K=$[1],T=(0,i.useState)(l),V=(0,n.Z)(T,2),W=V[0],Y=V[1],H=(0,i.useState)(r),J=(0,n.Z)(H,2),Q=J[0],X=J[1],ee=(0,i.useState)(o),ae=(0,n.Z)(ee,2),te=ae[0],ne=ae[1],se=(0,i.useState)(b.toString()),ie=(0,n.Z)(se,2),le=ie[0],re=ie[1],oe=(0,i.useState)(P),ce=(0,n.Z)(oe,2),de=ce[0],ue=ce[1],me=(0,i.useState)(R?Math.floor(parseInt(R,10)/1e9).toString():""),he=(0,n.Z)(me,2),ge=he[0],xe=he[1],ve=(0,i.useState)(S),Ze=(0,n.Z)(ve,2),je=Ze[0],pe=Ze[1],Ce=(0,i.useState)(I),fe=(0,n.Z)(Ce,2),Ne=fe[0],be=fe[1],Se=(0,i.useState)({}),Ie=(0,n.Z)(Se,2),Ae=Ie[0],ye=Ie[1],Pe=(0,i.useState)({}),Re=(0,n.Z)(Pe,2),qe=Re[0],ke=Re[1],ze=(0,i.useState)({}),we=(0,n.Z)(ze,2),Me=we[0],Ge=we[1],Fe=function(e){for(var a=[],t=0;t<e.length;t++)""!==e[t].key&&a.push(e[t]);return a};(0,i.useEffect)((function(){var e=[];e.push({fieldKey:"image",required:!1,value:W,pattern:/^([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9]?)+(\/(([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9])?)+)*:([a-zA-Z0-9])[a-zA-Z0-9-.]{0,127}$/,customPatternMessage:"Invalid image"}),e.push({fieldKey:"sidecarImage",required:!1,value:Q,pattern:/^([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9]?)+(\/(([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9])?)+)*:([a-zA-Z0-9])[a-zA-Z0-9-.]{0,127}$/,customPatternMessage:"Invalid image"}),e.push({fieldKey:"initImage",required:!1,value:te,pattern:/^([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9]?)+(\/(([a-zA-Z0-9])([a-zA-Z0-9-._])*([a-zA-Z0-9])?)+)*:([a-zA-Z0-9])[a-zA-Z0-9-.]{0,127}$/,customPatternMessage:"Invalid image"}),e.push({fieldKey:"diskCapacityGB",required:!0,value:le,pattern:/^[0-9]*$/,customPatternMessage:"Must be an integer between 0 and 10"}),e.push({fieldKey:"newCPURequest",required:!1,value:de,pattern:/^[0-9]*$/,customPatternMessage:"Must be an integer between 0 and 10"}),e.push({fieldKey:"newMemRequest",required:!1,value:ge,pattern:/^[0-9]*$/,customPatternMessage:"Must be an integer between 0 and 10"}),e.push({fieldKey:"serviceAccountName",required:!1,value:je,pattern:/^[a-zA-Z0-9-.]{1,253}$/,customPatternMessage:"Invalid service account name"}),e.push({fieldKey:"storageClassName",required:!1,value:Ne,pattern:/^[a-zA-Z0-9-.]{1,253}$/,customPatternMessage:"Invalid storage class name"});var a=(0,C.R)(e);w(a)}),[W,Q,te,le,je,Ne,de,ge,w]);return(0,N.jsx)(x.Z,{onClose:function(){return s(!0)},modalOpen:t,title:"Edit Monitoring Configuration",children:(0,N.jsx)("form",{noValidate:!0,autoComplete:"off",onSubmit:function(e){e.preventDefault(),Z.Z.invoke("PUT","/api/v1/namespaces/".concat(y,"/tenants/").concat(A,"/monitoring"),{labels:Fe(F),annotations:Fe(U),nodeSelector:Fe(_),image:W,sidecarImage:Q,initImage:te,diskCapacityGB:le,serviceAccountName:je,storageClassName:Ne,monitoringCPURequest:de,monitoringMemRequest:ge+"Gi"}).then((function(){s(!0)})).catch((function(e){}))},children:(0,N.jsxs)(c.ZP,{container:!0,children:[(0,N.jsxs)(c.ZP,{xs:12,className:a.modalFormScrollable,children:[(0,N.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,N.jsx)(p.Z,{id:"image",label:"Image",placeholder:"Image",name:"image",value:W,onChange:function(e){Y(e.target.value)},error:z.image||""},"image")}),(0,N.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,N.jsx)(p.Z,{id:"sidecarImage",label:"Sidecar Image",placeholder:"Sidecar Image",name:"sidecarImage",value:Q,onChange:function(e){X(e.target.value)},error:z.sidecarImage||""},"sidecarImage")}),(0,N.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,N.jsx)(p.Z,{id:"initImage",label:"Init Image",placeholder:"Init Image",name:"initImage",value:te,onChange:function(e){ne(e.target.value)},error:z.initImage||""},"initImage")}),(0,N.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,N.jsx)(p.Z,{id:"diskCapacityGB",label:"Disk Capacity",placeholder:"Disk Capacity",name:"diskCapacityGB",value:le,onChange:function(e){re(e.target.value)},error:z.diskCapacityGB||"",overlayObject:(0,N.jsx)(f.Z,{id:"size-unit",onUnitChange:function(){},unitSelected:"Gi",unitsList:[{label:"Gi",value:"Gi"}],disabled:!0})},"diskCapacityGB")}),(0,N.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,N.jsx)(p.Z,{id:"cpuRequest",label:"CPU Request",placeholder:"CPU Request",name:"cpuRequest",value:de,onChange:function(e){ue(e.target.value)},error:z.cpuRequest||""},"cpuRequest")}),(0,N.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,N.jsx)(p.Z,{id:"memRequest",label:"Memory Request",placeholder:"Memory request",name:"memRequest",value:ge,onChange:function(e){e.target.validity.valid&&xe(e.target.value)},pattern:"[0-9]*",error:z.memRequest||"",overlayObject:(0,N.jsx)(f.Z,{id:"size-unit",onUnitChange:function(){},unitSelected:"Gi",unitsList:[{label:"Gi",value:"Gi"}],disabled:!0})},"memRequest")}),(0,N.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,N.jsx)(p.Z,{id:"serviceAccountName",label:"Service Account",placeholder:"Service Account Name",name:"serviceAccountName",value:je,onChange:function(e){pe(e.target.value)},error:z.serviceAccountName||""},"serviceAccountName")}),(0,N.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,N.jsx)(p.Z,{id:"storageClassName",label:"Storage Class",placeholder:"Storage Class Name",name:"storageClassName",value:Ne,onChange:function(e){be(e.target.value)},error:z.storageClassName||""},"storageClassName")}),(0,N.jsxs)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:[(0,N.jsx)("span",{className:a.inputLabel,children:"Labels"}),(0,N.jsx)(j.Z,{newValues:F,setNewValues:E,paramName:"Labels",error:Ae,setError:ye})]}),(0,N.jsxs)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:[(0,N.jsx)("span",{className:a.inputLabel,children:"Annotations"}),(0,N.jsx)(j.Z,{newValues:U,setNewValues:D,paramName:"Annotations",error:qe,setError:ke})]}),(0,N.jsxs)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:[(0,N.jsx)("span",{className:a.inputLabel,children:"Node Selector"}),(0,N.jsx)(j.Z,{newValues:_,setNewValues:K,paramName:"Node Selector",error:Me,setError:Ge})]})]}),(0,N.jsx)(c.ZP,{xs:12,className:a.buttonContainer,children:(0,N.jsx)(v.Z,{type:"submit",variant:"contained",color:"primary",disabled:!function(){if(0!==Object.keys(z).length||0!==Object.keys(Ae).length||0!==Object.keys(qe).length||0!==Object.keys(Me).length){return(0,h.zb)({errorMessage:"Invalid entry",detailedError:""}),!1}return!0}(),children:"Save"})})]})})})})),S=t(92388),I=t(37516),A=t(47879),y=t(45248),P=t(2148),R=t(40603),q=t(72401),k={setErrorSnackMessage:h.Ih},z=(0,l.$j)(null,k),w=(0,o.Z)((function(e){return(0,r.Z)((0,s.Z)((0,s.Z)((0,s.Z)((0,s.Z)({},d.oZ),{},{headerLabel:{fontSize:22,fontWeight:600,color:"#000",marginTop:4},breadcrumLink:{textDecoration:"none",color:"black"},tableWrapper:{height:"calc(100vh - 267px)"},paperContainer:{padding:"15px 15px 15px 50px"}},d.OR),d.qg),(0,d.Bz)(e.spacing(4))))}))(z((function(e){var a=e.classes,t=e.match,s=e.tenant,l=e.loadingTenant,r=(0,i.useState)(!1),o=(0,n.Z)(r,2),d=o[0],g=o[1],x=(0,i.useState)(!1),v=(0,n.Z)(x,2),j=v[0],p=v[1],C=(0,i.useState)(),f=(0,n.Z)(C,2),k=f[0],z=f[1],w=(0,i.useState)(!1),M=(0,n.Z)(w,2),G=M[0],F=M[1],E=(0,i.useState)(!0),B=(0,n.Z)(E,2),L=B[0],U=B[1],D=t.params.tenantName,O=t.params.tenantNamespace;(0,i.useEffect)((function(){L&&Z.Z.invoke("GET","/api/v1/namespaces/".concat(O,"/tenants/").concat(D,"/monitoring")).then((function(e){g(e.prometheusEnabled),z(e),U(!1)})).catch((function(e){(0,h.Ih)(e),U(!1)}))}),[L]);return(0,N.jsxs)(i.Fragment,{children:[j&&null!==s&&d&&(0,N.jsx)(b,{classes:a,open:j,onClose:function(){p(!1),U(!0)},tenant:s,image:(null===k||void 0===k?void 0:k.image)||"",sidecarImage:(null===k||void 0===k?void 0:k.sidecarImage)||"",initImage:(null===k||void 0===k?void 0:k.initImage)||"",diskCapacityGB:null!==k&&void 0!==k&&k.diskCapacityGB?parseInt(null===k||void 0===k?void 0:k.diskCapacityGB):5,labels:(null===k||void 0===k?void 0:k.labels)||[],annotations:(null===k||void 0===k?void 0:k.annotations)||[],nodeSelector:(null===k||void 0===k?void 0:k.nodeSelector)||[],serviceAccountName:(null===k||void 0===k?void 0:k.serviceAccountName)||"",tenantName:D,tenantNamespace:O,storageClassName:(null===k||void 0===k?void 0:k.storageClassName)||"",cpuRequest:(null===k||void 0===k?void 0:k.monitoringCPURequest)||"",memRequest:(null===k||void 0===k?void 0:k.monitoringMemRequest)||""}),G&&(0,N.jsx)(P.Z,{isOpen:G,title:d?"Disable Prometheus monitoring?":"Enable Prometheus monitoring?",confirmText:d?"Disable":"Enable",cancelText:"Cancel",onClose:function(){return F(!1)},onConfirm:function(){var e={prometheusEnabled:d,toggle:!0};Z.Z.invoke("PUT","/api/v1/namespaces/".concat(O,"/tenants/").concat(D,"/monitoring"),e).then((function(){g(!d),U(!0),F(!1),U(!0)})).catch((function(e){(0,h.Ih)(e)}))},confirmationContent:(0,N.jsx)(u.Z,{children:d?"Disabling monitoring will erase any custom values you have used to configure Prometheus monitoring":"Prometheus monitoring will be enabled with default values"})}),(0,N.jsxs)(c.ZP,{container:!0,alignItems:"center",children:[(0,N.jsx)(c.ZP,{item:!0,xs:!0,children:(0,N.jsx)("h1",{className:a.sectionTitle,children:"Monitoring"})}),(0,N.jsx)(c.ZP,{item:!0,xs:4,children:(0,N.jsx)(I.Z,{indicatorLabels:["Enabled","Disabled"],checked:d,value:"monitoring_status",id:"monitoring-status",name:"monitoring-status",onChange:function(e){F(!0)},description:""})})]}),d&&void 0!==k&&(0,N.jsx)(m.Z,{className:a.paperContainer,children:(0,N.jsxs)(c.ZP,{container:!0,children:[(0,N.jsx)(c.ZP,{item:!0,xs:12,children:(0,N.jsxs)(c.ZP,{container:!0,alignItems:"center",children:[(0,N.jsx)(c.ZP,{xs:8,children:(0,N.jsx)("h3",{children:"Configuration"})}),(0,N.jsx)(c.ZP,{xs:4,justifyContent:"end",textAlign:"right",children:(0,N.jsx)(R.Z,{tooltip:"Edit Monitoring configuration",text:"Edit",onClick:function(){p(!0)},icon:(0,N.jsx)(S.dY,{}),color:"primary",variant:"contained"})})]})}),(0,N.jsxs)(c.ZP,{item:!0,xs:12,children:[(0,N.jsx)("hr",{className:a.hrClass}),(0,N.jsx)("table",{width:"100%",children:(0,N.jsx)("tbody",{children:l?(0,N.jsx)("tr",{children:(0,N.jsx)("td",{className:a.centerAlign,colSpan:4,children:(0,N.jsx)(q.Z,{})})}):(0,N.jsxs)(i.Fragment,{children:[null!=k.image&&(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{className:a.titleCol,children:"Image:"}),(0,N.jsx)("td",{children:k.image})]}),null!=k.sidecarImage&&(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{className:a.titleCol,children:"Sidecar Image:"}),(0,N.jsx)("td",{children:null===k||void 0===k?void 0:k.sidecarImage})]}),null!=k.initImage&&(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{className:a.titleCol,children:"Init Image:"}),(0,N.jsx)("td",{children:null===k||void 0===k?void 0:k.initImage})]}),null!=k.diskCapacityGB&&(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{className:a.titleCol,children:"Disk Capacity (GB):"}),(0,N.jsx)("td",{children:null===k||void 0===k?void 0:k.diskCapacityGB})]}),null!=k.serviceAccountName&&(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{className:a.titleCol,children:"Service Account Name:"}),(0,N.jsx)("td",{children:null===k||void 0===k?void 0:k.serviceAccountName})]}),null!=k.storageClassName&&(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{className:a.titleCol,children:"Storage Class Name:"}),(0,N.jsx)("td",{children:null===k||void 0===k?void 0:k.storageClassName})]}),null!=k.labels&&k.labels.length>0&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("tr",{children:(0,N.jsx)("td",{children:(0,N.jsx)("h4",{children:"Labels"})})}),(0,N.jsx)("tr",{children:(0,N.jsx)("td",{className:a.titleCol,children:(0,N.jsx)(A.Z,{records:k.labels,recordName:"Labels"})})})]}),null!=k.annotations&&k.annotations.length>0&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("tr",{children:(0,N.jsx)("td",{children:(0,N.jsx)("h4",{children:"Annotations"})})}),(0,N.jsx)("tr",{children:(0,N.jsx)("td",{className:a.titleCol,children:(0,N.jsx)(A.Z,{records:k.annotations,recordName:"Annotations"})})})]}),null!=k.monitoringCPURequest&&(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{className:a.titleCol,children:"CPU Request:"}),(0,N.jsx)("td",{children:null===k||void 0===k?void 0:k.monitoringCPURequest})]}),null!=k.monitoringMemRequest&&(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{className:a.titleCol,children:"Memory Request:"}),(0,N.jsx)("td",{children:(0,y.ae)(null===k||void 0===k?void 0:k.monitoringMemRequest,!0)})]}),null!=k.nodeSelector&&k.nodeSelector.length>0&&(0,N.jsxs)("tr",{children:[(0,N.jsx)("h4",{children:"Node Selector:"}),(0,N.jsx)("td",{className:a.titleCol,children:(0,N.jsx)(A.Z,{records:k.nodeSelector,recordName:"Node Selector"})})]})]})})})]})]})})]})})))}}]);
//# sourceMappingURL=9449.83d73a19.chunk.js.map