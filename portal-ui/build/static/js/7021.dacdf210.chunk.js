"use strict";(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[7021],{37021:function(e,a,n){n.r(a);var t=n(93433),r=n(29439),i=n(1413),o=n(11135),l=n(25787),s=n(23814),c=n(61889),d=n(72791),u=n(51691),_=n(20890),m=n(36151),p=n(81207),v=n(42649),h=n(60364),f=n(72401),Z=n(83679),x=n(21435),D=n(84741),g=n(40968),I=n(37516),j=n(20165),S=n(3579),N=n(2148),b=n(62410),k=n(80184),R={setErrorSnackMessage:v.Ih},y=(0,h.$j)((function(e){return{loadingTenant:e.tenants.tenantDetails.loadingTenant,selectedTenant:e.tenants.tenantDetails.currentTenant,tenant:e.tenants.tenantDetails.tenantInfo}}),R);a.default=(0,l.Z)((function(e){return(0,o.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)({},s.oZ),s.bK),{},{loaderAlign:{textAlign:"center"},bold:{fontWeight:"bold"},italic:{fontStyle:"italic"},fileItem:{marginRight:10,display:"flex","& div label":{minWidth:50},"@media (max-width: 900px)":{flexFlow:"column"}}},(0,s.Bz)(e.spacing(4))),s.QV),s.DF),s.oO),s.AK))}))(y((function(e){var a=e.classes,n=e.tenant,i=e.loadingTenant,o=e.setErrorSnackMessage,l=(0,d.useState)(!1),s=(0,r.Z)(l,2),v=s[0],h=s[1],R=(0,d.useState)(!1),y=(0,r.Z)(R,2),C=y[0],w=y[1],F=(0,d.useState)("Built-in"),A=(0,r.Z)(F,2),L=A[0],P=A[1],O=(0,d.useState)(""),T=(0,r.Z)(O,2),U=T[0],B=T[1],q=(0,d.useState)(""),K=(0,r.Z)(q,2),z=K[0],G=K[1],M=(0,d.useState)(""),E=(0,r.Z)(M,2),V=E[0],W=E[1],Q=(0,d.useState)(!1),$=(0,r.Z)(Q,2),H=$[0],J=$[1],X=(0,d.useState)(""),Y=(0,r.Z)(X,2),ee=Y[0],ae=Y[1],ne=(0,d.useState)(""),te=(0,r.Z)(ne,2),re=te[0],ie=te[1],oe=(0,d.useState)(""),le=(0,r.Z)(oe,2),se=le[0],ce=le[1],de=(0,d.useState)(""),ue=(0,r.Z)(de,2),_e=ue[0],me=ue[1],pe=(0,d.useState)(""),ve=(0,r.Z)(pe,2),he=ve[0],fe=ve[1],Ze=(0,d.useState)(""),xe=(0,r.Z)(Ze,2),De=xe[0],ge=xe[1],Ie=(0,d.useState)(!1),je=(0,r.Z)(Ie,2),Se=je[0],Ne=je[1],be=(0,d.useState)(""),ke=(0,r.Z)(be,2),Re=ke[0],ye=ke[1],Ce=(0,d.useState)(""),we=(0,r.Z)(Ce,2),Fe=we[0],Ae=we[1],Le=(0,d.useState)(""),Pe=(0,r.Z)(Le,2),Oe=Pe[0],Te=Pe[1],Ue=(0,d.useState)(""),Be=(0,r.Z)(Ue,2),qe=Be[0],Ke=Be[1],ze=(0,d.useState)(!1),Ge=(0,r.Z)(ze,2),Me=Ge[0],Ee=Ge[1],Ve=(0,d.useState)(!1),We=(0,r.Z)(Ve,2),Qe=We[0],$e=We[1],He=(0,d.useState)(!1),Je=(0,r.Z)(He,2),Xe=Je[0],Ye=Je[1],ea=(0,d.useState)({}),aa=(0,r.Z)(ea,2),na=aa[0],ta=aa[1],ra=function(e){ta((0,D.h)(na,e))},ia=(0,d.useState)(!1),oa=(0,r.Z)(ia,2),la=oa[0],sa=oa[1];(0,d.useEffect)((function(){var e=[];"OpenID"===L&&(e=[].concat((0,t.Z)(e),[{fieldKey:"openID_CONFIGURATION_URL",required:!0,value:U},{fieldKey:"openID_clientID",required:!0,value:z},{fieldKey:"openID_secretID",required:!0,value:V},{fieldKey:"openID_claimName",required:!0,value:re}])),"AD"===L&&(e=[].concat((0,t.Z)(e),[{fieldKey:"AD_URL",required:!0,value:_e},{fieldKey:"ad_lookupBindDN",required:!0,value:he}]));var a=(0,g.R)(e);sa(0===Object.keys(a).length),ta(a)}),[L,U,z,V,re,_e,he]);var ca=(0,d.useCallback)((function(){p.Z.invoke("GET","/api/v1/namespaces/".concat(null===n||void 0===n?void 0:n.namespace,"/tenants/").concat(null===n||void 0===n?void 0:n.name,"/identity-provider")).then((function(e){e&&(e.oidc?(P("OpenID"),B(e.oidc.configuration_url),G(e.oidc.client_id),W(e.oidc.secret_id),ae(e.oidc.callback_url),ie(e.oidc.claim_name),ce(e.oidc.scopes)):e.active_directory&&(P("AD"),me(e.active_directory.url),fe(e.active_directory.lookup_bind_dn),ge(e.active_directory.lookup_bind_password),ye(e.active_directory.user_dn_search_base_dn),Ae(e.active_directory.user_dn_search_filter),Te(e.active_directory.group_search_base_dn),Ke(e.active_directory.group_search_filter),Ee(e.active_directory.skip_tls_verification),$e(e.active_directory.server_insecure),Ye(e.active_directory.server_start_tls)))})).catch((function(e){o(e)}))}),[n,o]);(0,d.useEffect)((function(){n&&ca()}),[n,ca]);return(0,k.jsxs)(d.Fragment,{children:[(0,k.jsx)(N.Z,{title:"Save and Restart",confirmText:"Restart",cancelText:"Cancel",titleIcon:(0,k.jsx)(b.EjK,{}),isLoading:v,onClose:function(){return w(!1)},isOpen:C,onConfirm:function(){h(!0);var e={};switch(L){case"AD":e.active_directory={url:_e,lookup_bind_dn:he,lookup_bind_password:De,user_dn_search_base_dn:Re,user_dn_search_filter:Fe,group_search_base_dn:Oe,group_search_filter:qe,skip_tls_verification:Me,server_insecure:Qe,server_start_tls:Xe};break;case"OpenID":e.oidc={configuration_url:U,client_id:z,secret_id:V,callback_url:ee,claim_name:re,scopes:se}}p.Z.invoke("POST","/api/v1/namespaces/".concat(null===n||void 0===n?void 0:n.namespace,"/tenants/").concat(null===n||void 0===n?void 0:n.name,"/identity-provider"),e).then((function(){h(!1),w(!1),ca()})).catch((function(e){o(e),h(!1)}))},confirmationContent:(0,k.jsx)(u.Z,{children:"Are you sure you want to save the changes and restart the service?"})}),i?(0,k.jsx)("div",{className:a.loaderAlign,children:(0,k.jsx)(f.Z,{})}):(0,k.jsxs)(d.Fragment,{children:[(0,k.jsxs)(c.ZP,{item:!0,xs:12,children:[(0,k.jsx)("h1",{className:a.sectionTitle,children:"Identity Provider"}),(0,k.jsx)("hr",{className:a.hrClass})]}),(0,k.jsx)(c.ZP,{item:!0,xs:12,className:a.protocolRadioOptions,children:(0,k.jsx)(Z.Z,{currentSelection:L,id:"idp-options",name:"idp-options",label:"Protocol",onChange:function(e){P(e.target.value)},selectorOptions:[{label:"Built-in",value:"Built-in"},{label:"OpenID",value:"OpenID"},{label:"Active Directory",value:"AD"}]})}),"OpenID"===L&&(0,k.jsxs)(d.Fragment,{children:[(0,k.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,k.jsx)(x.Z,{id:"openID_CONFIGURATION_URL",name:"openID_CONFIGURATION_URL",onChange:function(e){B(e.target.value),ra("openID_CONFIGURATION_URL")},label:"Configuration URL",value:U,placeholder:"https://your-identity-provider.com/.well-known/openid-configuration",error:na.openID_CONFIGURATION_URL||"",required:!0})}),(0,k.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,k.jsx)(x.Z,{id:"openID_clientID",name:"openID_clientID",onChange:function(e){G(e.target.value),ra("openID_clientID")},label:"Client ID",value:z,error:na.openID_clientID||"",required:!0})}),(0,k.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,k.jsx)(x.Z,{type:H?"text":"password",id:"openID_secretID",name:"openID_secretID",onChange:function(e){W(e.target.value),ra("openID_secretID")},label:"Secret ID",value:V,error:na.openID_secretID||"",required:!0,overlayIcon:H?(0,k.jsx)(j.Z,{}):(0,k.jsx)(S.Z,{}),overlayAction:function(){return J(!H)}})}),(0,k.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,k.jsx)(x.Z,{id:"openID_callbackURL",name:"openID_callbackURL",onChange:function(e){ae(e.target.value),ra("openID_callbackURL")},label:"Callback URL",value:ee,placeholder:"https://your-console-endpoint:9443/oauth_callback",error:na.openID_callbackURL||""})}),(0,k.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,k.jsx)(x.Z,{id:"openID_claimName",name:"openID_claimName",onChange:function(e){ie(e.target.value),ra("openID_claimName")},label:"Claim Name",value:re,error:na.openID_claimName||"",required:!0})}),(0,k.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,k.jsx)(x.Z,{id:"openID_scopes",name:"openID_scopes",onChange:function(e){ce(e.target.value),ra("openID_scopes")},label:"Scopes",value:se})})]}),"AD"===L&&(0,k.jsxs)(d.Fragment,{children:[(0,k.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,k.jsx)(x.Z,{id:"AD_URL",name:"AD_URL",onChange:function(e){me(e.target.value),ra("AD_URL")},label:"LDAP Server Address",value:_e,placeholder:"ldap-server:636",error:na.AD_URL||"",required:!0})}),(0,k.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,k.jsx)(I.Z,{value:"ad_skipTLS",id:"ad_skipTLS",name:"ad_skipTLS",checked:Me,onChange:function(e){var a=e.target.checked;Ee(a)},label:"Skip TLS Verification"})}),(0,k.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,k.jsx)(I.Z,{value:"ad_serverInsecure",id:"ad_serverInsecure",name:"ad_serverInsecure",checked:Qe,onChange:function(e){var a=e.target.checked;$e(a)},label:"Server Insecure"})}),Qe?(0,k.jsxs)(c.ZP,{item:!0,xs:12,children:[(0,k.jsx)(_.Z,{className:a.error,variant:"caption",display:"block",gutterBottom:!0,children:"Warning: All traffic with Active Directory will be unencrypted"}),(0,k.jsx)("br",{})]}):null,(0,k.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,k.jsx)(I.Z,{value:"ad_serverStartTLS",id:"ad_serverStartTLS",name:"ad_serverStartTLS",checked:Xe,onChange:function(e){var a=e.target.checked;Ye(a)},label:"Start TLS connection to AD/LDAP server"})}),(0,k.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,k.jsx)(x.Z,{id:"ad_lookupBindDN",name:"ad_lookupBindDN",onChange:function(e){fe(e.target.value),ra("ad_lookupBindDN")},label:"Lookup Bind DN",value:he,placeholder:"cn=admin,dc=min,dc=io",error:na.ad_lookupBindDN||"",required:!0})}),(0,k.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,k.jsx)(x.Z,{type:Se?"text":"password",id:"ad_lookupBindPassword",name:"ad_lookupBindPassword",onChange:function(e){ge(e.target.value)},label:"Lookup Bind Password",value:De,placeholder:"admin",overlayIcon:Se?(0,k.jsx)(j.Z,{}):(0,k.jsx)(S.Z,{}),overlayAction:function(){return Ne(!Se)}})}),(0,k.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,k.jsx)(x.Z,{id:"ad_userDNSearchBaseDN",name:"ad_userDNSearchBaseDN",onChange:function(e){ye(e.target.value)},label:"User DN Search Base DN",value:Re,placeholder:"dc=min,dc=io"})}),(0,k.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,k.jsx)(x.Z,{id:"ad_userDNSearchFilter",name:"ad_userDNSearchFilter",onChange:function(e){Ae(e.target.value)},label:"User DN Search Filter",value:Fe,placeholder:"(sAMAcountName=%s)"})}),(0,k.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,k.jsx)(x.Z,{id:"ad_groupSearchBaseDN",name:"ad_groupSearchBaseDN",onChange:function(e){Te(e.target.value)},label:"Group Search Base DN",value:Oe,placeholder:"ou=hwengg,dc=min,dc=io;ou=swengg,dc=min,dc=io"})}),(0,k.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,k.jsx)(x.Z,{id:"ad_groupSearchFilter",name:"ad_groupSearchFilter",onChange:function(e){Ke(e.target.value)},label:"Group Search Filter",value:qe,placeholder:"(&(objectclass=groupOfNames)(member=%s))"})})]}),(0,k.jsx)(c.ZP,{item:!0,xs:12,className:a.buttonContainer,children:(0,k.jsx)(m.Z,{type:"submit",variant:"contained",color:"primary",disabled:!la||v,onClick:function(){return w(!0)},children:"Save"})})]})]})})))},3579:function(e,a,n){var t=n(95318);a.Z=void 0;var r=t(n(45649)),i=n(80184),o=(0,r.default)((0,i.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"}),"RemoveRedEye");a.Z=o},20165:function(e,a,n){var t=n(95318);a.Z=void 0;var r=t(n(45649)),i=n(80184),o=(0,r.default)((0,i.jsx)("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"}),"VisibilityOff");a.Z=o}}]);
//# sourceMappingURL=7021.dacdf210.chunk.js.map