"use strict";(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[6173],{96173:function(e,t,n){n.r(t),n.d(t,{default:function(){return E}});var i=n(23430),a=n(18489),s=n(50390),l=n(34424),r=n(86509),c=n(4285),o=n(25594),d=n(44149),u=n(72462),m=n(30140),x=n(49495),h=n(14549),p=n(30324),f=n(8174),Z=n(8235),j=n(48122),g=n(37882),b=n(53224),k=n(66946),R=n(51002),v=n(66964),S=n(65703),N=n(50280),C=n(92440),P=n(62559),F=(0,l.$j)(null,{setModalErrorSnackMessage:d.zb}),y=(0,c.Z)((function(e){return(0,r.Z)((0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)({buttonContainer:{textAlign:"right"},multiContainer:{display:"flex",alignItems:"center"},sizeFactorContainer:{"& label":{display:"none"},"& div:first-child":{marginBottom:0}}},u.bK),u.QV),u.DF),u.ID),{},{modalFormScrollable:(0,a.Z)((0,a.Z)({},u.ID.modalFormScrollable),{},{paddingRight:10})}))}))(F((function(e){var t=e.closeModalAndRefresh,n=e.open,a=e.classes,l=e.bucketName,r=e.ruleID,c=e.setModalErrorSnackMessage,d=(0,s.useState)(!0),u=(0,i.Z)(d,2),m=u[0],x=u[1],f=(0,s.useState)(!1),Z=(0,i.Z)(f,2),j=Z[0],g=Z[1],b=(0,s.useState)("1"),F=(0,i.Z)(b,2),y=F[0],I=F[1],T=(0,s.useState)(""),A=(0,i.Z)(T,2),E=A[0],D=A[1],O=(0,s.useState)(""),_=(0,i.Z)(O,2),w=_[0],M=_[1],G=(0,s.useState)(!1),U=(0,i.Z)(G,2),B=U[0],L=U[1],K=(0,s.useState)(!1),z=(0,i.Z)(K,2),H=z[0],V=z[1],Y=(0,s.useState)(""),$=(0,i.Z)(Y,2),q=$[0],J=$[1],Q=(0,s.useState)(""),W=(0,i.Z)(Q,2),X=W[0],ee=W[1],te=(0,s.useState)(""),ne=(0,i.Z)(te,2),ie=ne[0],ae=ne[1],se=(0,s.useState)(!1),le=(0,i.Z)(se,2),re=le[0],ce=le[1],oe=(0,s.useState)(!1),de=(0,i.Z)(oe,2),ue=de[0],me=de[1],xe=(0,s.useState)(!1),he=(0,i.Z)(xe,2),pe=he[0],fe=he[1];return(0,s.useEffect)((function(){m&&p.Z.invoke("GET","/api/v1/buckets/".concat(l,"/replication/").concat(r)).then((function(e){I(e.priority.toString());var t=e.prefix||"",n=e.tags||"";M(t),J(n),ee(n),D(e.destination.bucket),L(e.delete_marker_replication),ae(e.storageClass||""),ce(!!e.existingObjects),me(!!e.deletes_replication),fe("Enabled"===e.status),V(!!e.metadata_replication),x(!1)})).catch((function(e){c(e),x(!1)}))}),[m,c,l,r]),(0,s.useEffect)((function(){if(j){var e={arn:E,ruleState:pe,prefix:w,tags:X,replicateDeleteMarkers:B,replicateDeletes:ue,replicateExistingObjects:re,replicateMetadata:H,priority:parseInt(y),storageClass:ie};p.Z.invoke("PUT","/api/v1/buckets/".concat(l,"/replication/").concat(r),e).then((function(){g(!1),t(!0)})).catch((function(e){c(e),g(!1)}))}}),[j,l,r,E,w,X,B,y,ue,re,pe,H,ie,t,c]),(0,P.jsx)(R.Z,{modalOpen:n,onClose:function(){t(!1)},title:"Edit Bucket Replication",titleIcon:(0,P.jsx)(h.xR,{}),children:(0,P.jsx)("form",{noValidate:!0,autoComplete:"off",onSubmit:function(e){e.preventDefault(),g(!0)},children:(0,P.jsxs)(o.ZP,{container:!0,children:[(0,P.jsxs)(o.ZP,{item:!0,xs:12,className:a.modalFormScrollable,children:[(0,P.jsx)(o.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,P.jsx)(C.Z,{checked:pe,id:"ruleState",name:"ruleState",label:"Rule State",onChange:function(e){fe(e.target.checked)},value:pe})}),(0,P.jsx)(o.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,P.jsx)(N.Z,{label:"Destination",content:E})}),(0,P.jsx)(o.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,P.jsx)(v.Z,{id:"priority",name:"priority",onChange:function(e){e.target.validity.valid&&I(e.target.value)},label:"Priority",value:y,pattern:"[0-9]*"})}),(0,P.jsx)(o.ZP,{item:!0,xs:12,className:"".concat(a.spacerTop," ").concat(a.formFieldRow),children:(0,P.jsx)(v.Z,{id:"storageClass",name:"storageClass",onChange:function(e){ae(e.target.value)},placeholder:"STANDARD_IA,REDUCED_REDUNDANCY etc",label:"Storage Class",value:ie})}),(0,P.jsx)(o.ZP,{item:!0,xs:12,children:(0,P.jsxs)("fieldset",{className:a.fieldGroup,children:[(0,P.jsx)("legend",{className:a.descriptionText,children:"Object Filters"}),(0,P.jsx)(o.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,P.jsx)(v.Z,{id:"prefix",name:"prefix",onChange:function(e){M(e.target.value)},placeholder:"prefix",label:"Prefix",value:w})}),(0,P.jsx)(o.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,P.jsx)(S.Z,{name:"tags",label:"Tags",elements:q,onChange:function(e){ee(e)},keyPlaceholder:"Tag Key",valuePlaceholder:"Tag Value",withBorder:!0})})]})}),(0,P.jsx)(o.ZP,{item:!0,xs:12,children:(0,P.jsxs)("fieldset",{className:a.fieldGroup,children:[(0,P.jsx)("legend",{className:a.descriptionText,children:"Replication Options"}),(0,P.jsx)(o.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,P.jsx)(C.Z,{checked:re,id:"repExisting",name:"repExisting",label:"Existing Objects",onChange:function(e){ce(e.target.checked)},value:re,description:"Replicate existing objects"})}),(0,P.jsx)(C.Z,{checked:H,id:"metadatataSync",name:"metadatataSync",label:"Metadata Sync",onChange:function(e){V(e.target.checked)},value:H,description:"Metadata Sync"}),(0,P.jsx)(o.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,P.jsx)(C.Z,{checked:B,id:"deleteMarker",name:"deleteMarker",label:"Delete Marker",onChange:function(e){L(e.target.checked)},value:B,description:"Replicate soft deletes"})}),(0,P.jsx)(o.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,P.jsx)(C.Z,{checked:ue,id:"repDelete",name:"repDelete",label:"Deletes",onChange:function(e){me(e.target.checked)},value:ue,description:"Replicate versioned deletes"})})]})})]}),(0,P.jsxs)(o.ZP,{item:!0,xs:12,className:a.modalButtonBar,children:[(0,P.jsx)(k.Z,{type:"button",variant:"outlined",color:"primary",disabled:m||j,onClick:function(){t(!1)},children:"Cancel"}),(0,P.jsx)(k.Z,{type:"submit",variant:"contained",color:"primary",disabled:m||j,children:"Save"})]})]})})})}))),I=(0,g.Z)(s.lazy((function(){return n.e(6866).then(n.bind(n,86866))}))),T=(0,g.Z)(s.lazy((function(){return Promise.all([n.e(875),n.e(8564)]).then(n.bind(n,98564))}))),A=(0,l.$j)((function(e){return{session:e.console.session,loadingBucket:e.buckets.bucketDetails.loadingBucket,bucketInfo:e.buckets.bucketDetails.bucketInfo}}),{setErrorSnackMessage:d.Ih}),E=(0,c.Z)((function(e){return(0,r.Z)((0,a.Z)((0,a.Z)((0,a.Z)({},u.qg),u.OR),{},{twHeight:{minHeight:400}}))}))(A((function(e){var t=e.classes,n=e.match,a=e.setErrorSnackMessage,l=e.loadingBucket,r=(0,s.useState)(!0),c=(0,i.Z)(r,2),d=c[0],u=c[1],g=(0,s.useState)([]),k=(0,i.Z)(g,2),R=k[0],v=k[1],S=(0,s.useState)(!1),N=(0,i.Z)(S,2),C=N[0],F=N[1],A=(0,s.useState)(!1),E=(0,i.Z)(A,2),D=E[0],O=E[1],_=(0,s.useState)(!1),w=(0,i.Z)(_,2),M=w[0],G=w[1],U=(0,s.useState)(""),B=(0,i.Z)(U,2),L=B[0],K=B[1],z=(0,s.useState)(!1),H=(0,i.Z)(z,2),V=H[0],Y=H[1],$=n.params.bucketName,q=(0,m.F)($,[x.Ft.S3_GET_REPLICATION_CONFIGURATION]);(0,s.useEffect)((function(){l&&u(!0)}),[l,u]),(0,s.useEffect)((function(){d&&(q?p.Z.invoke("GET","/api/v1/buckets/".concat($,"/replication")).then((function(e){var t=e.rules?e.rules:[];t.sort((function(e,t){return e.priority-t.priority})),v(t),u(!1)})).catch((function(e){a(e),u(!1)})):u(!1))}),[d,a,$,q]);var J=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];O(e)},Q=[{type:"delete",onClick:function(e){K(e.id),Y(!1),F(!0)}},{type:"view",onClick:function(e){K(e.id),G(!0)},disableButtonFunction:!(0,m.F)($,[x.Ft.S3_PUT_REPLICATION_CONFIGURATION],!0)}];return(0,P.jsxs)(s.Fragment,{children:[D&&(0,P.jsx)(I,{closeModalAndRefresh:function(){J(!1),u(!0)},open:D,bucketName:$,setReplicationRules:R}),C&&(0,P.jsx)(T,{deleteOpen:C,selectedBucket:$,closeDeleteModalAndRefresh:function(e){F(!1),e&&u(!0)},ruleToDelete:L,remainingRules:R.length,deleteAllRules:V}),M&&(0,P.jsx)(y,{closeModalAndRefresh:function(e){G(!1),e&&u(!0)},open:M,bucketName:$,ruleID:L}),(0,P.jsxs)(o.ZP,{container:!0,children:[(0,P.jsxs)(o.ZP,{item:!0,xs:12,className:t.actionsTray,children:[(0,P.jsx)(j.Z,{children:"Replication"}),(0,P.jsxs)("div",{children:[(0,P.jsx)(m.s,{scopes:[x.Ft.S3_PUT_REPLICATION_CONFIGURATION],resource:$,matchAll:!0,errorProps:{disabled:!0},children:(0,P.jsx)(b.Z,{tooltip:"Remove All Replication Rules",onClick:function(){K("allRules"),Y(!0),F(!0)},text:"Remove All Rules",icon:(0,P.jsx)(h.pJ,{}),color:"secondary",variant:"outlined",disabled:0===R.length})}),(0,P.jsx)(m.s,{scopes:[x.Ft.S3_PUT_REPLICATION_CONFIGURATION],resource:$,matchAll:!0,errorProps:{disabled:!0},children:(0,P.jsx)(b.Z,{tooltip:"Add Replication Rule",onClick:function(){J(!0)},text:"Add Replication Rule",icon:(0,P.jsx)(h.dt,{}),color:"primary",variant:"contained"})})]})]}),(0,P.jsx)(o.ZP,{item:!0,xs:12,children:(0,P.jsx)(m.s,{scopes:[x.Ft.S3_GET_REPLICATION_CONFIGURATION],resource:$,errorProps:{disabled:!0},children:(0,P.jsx)(f.Z,{itemActions:Q,columns:[{label:"Priority",elementKey:"priority",width:55,contentTextAlign:"center"},{label:"Destination",elementKey:"destination",renderFunction:function(e){return(0,P.jsx)(s.Fragment,{children:e.bucket.replace("arn:aws:s3:::","")})}},{label:"Prefix",elementKey:"prefix",width:200},{label:"Tags",elementKey:"tags",renderFunction:function(e){return(0,P.jsx)(s.Fragment,{children:e&&""!==e.tags?"Yes":"No"})},width:60},{label:"Status",elementKey:"status",width:100}],isLoading:d,records:R,entityName:"Replication Rules",idField:"id",customPaperHeight:t.twHeight,textSelectable:!0})})}),(0,P.jsxs)(o.ZP,{item:!0,xs:12,children:[(0,P.jsx)("br",{}),(0,P.jsx)(Z.Z,{title:"Replication",iconComponent:(0,P.jsx)(h.wN,{}),help:(0,P.jsxs)(s.Fragment,{children:["MinIO supports server-side and client-side replication of objects between source and destination buckets.",(0,P.jsx)("br",{}),(0,P.jsx)("br",{}),"You can learn more at our"," ",(0,P.jsx)("a",{href:"https://docs.min.io/minio/baremetal/replication/replication-overview.html?ref=con",target:"_blank",rel:"noreferrer",children:"documentation"}),"."]})})]})]})]})})))},50280:function(e,t,n){var i=n(18489),a=n(50390),s=n(25594),l=n(86509),r=n(4285),c=n(72462),o=n(62559);t.Z=(0,r.Z)((function(e){return(0,l.Z)((0,i.Z)({},c.xx))}))((function(e){var t=e.classes,n=e.label,i=void 0===n?"":n,l=e.content,r=e.multiLine,c=void 0!==r&&r;return(0,o.jsx)(a.Fragment,{children:(0,o.jsxs)(s.ZP,{className:t.prefinedContainer,children:[""!==i&&(0,o.jsx)(s.ZP,{item:!0,xs:12,className:t.predefinedTitle,children:i}),(0,o.jsx)(s.ZP,{item:!0,xs:12,className:t.predefinedList,children:(0,o.jsx)(s.ZP,{item:!0,xs:12,className:c?t.innerContentMultiline:t.innerContent,children:l})})]})})}))},48122:function(e,t,n){n(50390);var i=n(86509),a=n(4285),s=n(62559);t.Z=(0,a.Z)((function(e){return(0,i.Z)({root:{padding:0,margin:0,fontSize:".9rem"}})}))((function(e){var t=e.classes,n=e.children;return(0,s.jsx)("h1",{className:t.root,children:n})}))}}]);
//# sourceMappingURL=6173.f2666144.chunk.js.map